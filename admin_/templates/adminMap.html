{% extends 'base.html' %}
{% load static %}

{% block link %}
    <title>ŸÜŸÇÿ¥Ÿá ÿßŸÖŸÑÿß⁄© Ÿà ŸÖÿ≥ÿ™ÿ∫ŸÑÿßÿ™</title>
    <link rel="stylesheet" href="{% static 'css/mainMap.css' %}">
    <link rel="stylesheet" href="{% static 'css/dependencies/persianDate.css' %}">
    <script src="{% static 'js/dependencies/persianDate.js' %}"></script>
    <style>
        .with-border {
            border: 2px solid #007bff;
            border-radius: 6px;
            padding: 10px;
        }
    </style>
    <style>
        #layersOffCanvas {
            border-top-right-radius: 15px;
            border-bottom-right-radius: 15px;
            overflow: hidden;
        }

        #map {
            height: 100%
        }

        .filtered-column {
            color: red !important;
        }

        #printMap {
            height: 370px;
            width: 100%;
            border-radius: 2%;
            overflow: hidden;
            position: relative;
        }

        .option {
            display: inline-block;
            padding: 10px;
            border: 1px solid #ccc;
            cursor: pointer;
            margin: 5px;
        }

        .selected {
            background-color: green;
            color: white;
        }

        .stepper {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .step {
            padding: 10px;
            border-left: 3px solid #ccc;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .active-step {
            border-color: #00e203;
            background-color: #e9ecef;
        }

        .content {
            display: none;
        }

        .active-content {
            display: block;
        }

        @keyframes expandWidth {
            from {
                flex-basis: 0;
            }
            to {
                flex-basis: 50%;
            }
        }

        @keyframes collapseWidth {
            from {
                flex-basis: 50%;
            }
            to {
                flex-basis: 0;
            }
        }

        #col3.expanded {
            animation: expandWidth 1s forwards;
        }

        #col3.collapsed {
            animation: collapseWidth 1s forwards;
            overflow-x: hidden;
        }

        .pointerCursor {
            cursor: pointer;
        }

        .rtl-input {
            direction: rtl;
            text-align: right;
        }

        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* ŸÜ€åŸÖŸá ÿ¥ŸÅÿßŸÅ */
            z-index: 1040; /* ÿ®ÿßŸÑÿßÿ™ÿ± ÿßÿ≤ ŸÖÿ≠ÿ™Ÿàÿß€å ŸÖÿπŸÖŸàŸÑ€å ÿßŸÖÿß Ÿæÿß€å€åŸÜ‚Äåÿ™ÿ± ÿßÿ≤ ŸÖÿØÿßŸÑ */
            backdrop-filter: blur(5px); /* ÿß€åÿ¨ÿßÿØ ÿßŸÅ⁄©ÿ™ ÿ™ÿßÿ± */
        }

    </style>
    <style>
        .chat-box {
            position: absolute;
            bottom: 60px;
            right: 0;
            width: 400px;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .chat-box {
            height: 400px;
        }
    </style>
    {# ---------------------- set scroll bar  #}
    <style>
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .container1 {
            display: flex;
        }

        .column {
            border: 1px solid #ccc;
            padding: 10px;
        }

        .resizer {
            background: #f1f1f1;
            width: 10px;
            cursor: col-resize;
        }

        .d-none {
            display: none;
        }
    </style>
    <style>
        .resizable {
            position: fixed; /* ÿ®Ÿá ÿ¨ÿß€å absoluteÿå ÿßÿ≤ fixed ÿßÿ≥ÿ™ŸÅÿßÿØŸá ⁄©ŸÜ€åÿØ */
            top: 0;
            left: 0;
            height: 100%;
            width: 200px; /* ÿπÿ±ÿ∂ Ÿæ€åÿ¥‚ÄåŸÅÿ±ÿ∂ */
            min-width: 150px;
            max-width: 600px;
            z-index: 1055; /* ÿ®ÿ±ÿß€å ÿßŸàŸÑŸà€åÿ™ ÿØÿ± ŸÜŸÖÿß€åÿ¥ */
            background-color: #fff; /* Ÿæÿ≥‚Äåÿ≤ŸÖ€åŸÜŸá */
            overflow: auto; /* ÿ®ÿ±ÿß€å ŸÖÿ≠ÿ™Ÿàÿß€å ÿ®€åÿ¥‚Äåÿßÿ≤ÿ≠ÿØ */
            border-right: 1px solid #ddd;
        }

        .resizer {
            position: absolute;
            top: 0;
            right: 0;
            width: 5px;
            height: 100%;
            cursor: ew-resize;
            background-color: #ccc;
        }

        #dropdownList {
            width: 80%;
            max-width: none;
            box-sizing: border-box;
        }

        #dropdownList {
            max-height: 200px;
            overflow-y: auto; /* ÿ®ÿ±ÿß€å ÿßÿ≥⁄©ÿ±ŸàŸÑ ÿØÿ± ÿµŸàÿ±ÿ™ ÿ≤€åÿßÿØ ÿ®ŸàÿØŸÜ ÿ¢€åÿ™ŸÖ‚ÄåŸáÿß */
        }

        #selectionResults {
            margin-top: 20px;
        }

        #selectedFeaturesList {
            list-style-type: none;
            padding-left: 0;
        }

        .filter-condition {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        .remove-condition-container {
            display: flex;
            align-items: center;
        }

        .remove-condition {
            margin-right: 10px;
        }

    </style>
    <style>
        .offcanvas {
            z-index: 1055;
        }

        .table-container {
            overflow-y: auto;
        }

        .resize-div {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background-color: #ccc;
            cursor: ns-resize;
            z-index: 1060;
        }


        .table-scroll-top {
            overflow-x: auto;
            transform: rotateX(180deg);
        }

        .table-scroll-top table {
            transform: rotateX(180deg);
            width: 100%;
            white-space: nowrap;
        }
    </style>
    <style>
        #search-input {
            position: relative;
            z-index: 10;
        }

        #search-results {
            position: absolute;
            top: 100%;
            left: 0;
            z-index: 1000;
        }

        .table-wrapper {
            overflow-x: auto;
            position: relative;
        }

        .sticky-column {
            position: sticky;
            left: 0;
            background-color: white;
            z-index: 10;
        }


    </style>
    <link rel="stylesheet" href="{% static 'css/new/leaflet.draw.css' %}"/>
    <style>
        .corner-coordinates {
            position: absolute;
            background: rgba(255, 255, 255, 0.85);
            font-size: 0.7rem;
            padding: 2px 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
            z-index: 1000;
            color: #000;
        }

        .top-left {
            top: 5px;
            left: 5px;
        }

        .top-right {
            top: 5px;
            right: 5px;
        }

        .bottom-left {
            bottom: 5px;
            left: 5px;
        }

        .bottom-right {
            bottom: 20px;
            right: 5px;
        }

        #printFrame {
            border: 3px solid #2c3e50;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            background-color: #fdfdfd;
            width: 100%;
            max-width: 1000px;
            margin: auto;
        }

        .print-frame {
            border: 3px solid #2c3e50;
            border-radius: 12px;
            padding: 5px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            background-color: #ffffff;
            width: 100%;
            max-width: 1000px;
            margin: auto;
        }
    </style>
    <style>
        .leaflet-draw-draw-polygon::before {
            content: "üî∫";
            font-size: 16px;
            display: block;
            text-align: center;
            line-height: 30px;
        }

        .leaflet-draw-draw-rectangle::before {
            content: "‚¨õ";
            font-size: 16px;
            display: block;
            text-align: center;
            line-height: 30px;
        }

        .leaflet-draw-edit-edit::before {
            content: "‚úèÔ∏è"; /* ÿ¢€å⁄©ŸàŸÜ Ÿà€åÿ±ÿß€åÿ¥ */
            font-size: 16px;
            display: block;
            text-align: center;
            line-height: 30px;
        }

        .leaflet-draw-edit-remove::before {
            content: "üóëÔ∏è"; /* ÿ¢€å⁄©ŸàŸÜ ÿ≠ÿ∞ŸÅ */
            font-size: 16px;
            display: block;
            text-align: center;
            line-height: 30px;
        }


    </style>
{% endblock %}

{% block body %}
    <div class="container1">
        <div class="column" id="col2" style="flex-basis: 100%">
            <div id="map"></div>
        </div>
        <div class="resizer" id="resizer2"></div>
        <div class="column p-2 d-none" id="col3" style="flex-basis: 0" dir="rtl">
        </div>
    </div>

    <div class="modal text-right" tabindex="-1" id="reportModal" dir="rtl">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="text-center mt-2">
                    <h4>ŸÖÿ¥ÿßŸáÿØŸá ÿ≥ÿßÿ®ŸÇŸá ÿ™ÿ∫€å€åÿ±ÿßÿ™</h4>
                </div>
                <div class="row pt-auto p-1">
                    <div class="col-auto"><span>ŸÅ€åŸÑÿ™ÿ± ⁄Øÿ∞ÿßÿ±€å</span></div>
                    <div class="col-auto"><input class=" form-control form-control-sm" data-jdp id="firstDate"
                                                 placeholder="ÿ™ÿßÿ±€åÿÆ ÿ¥ÿ±Ÿàÿπ ŸÅ€åŸÑÿ™ÿ±"></div>
                    <div class="col-auto"><input class="form-control form-control-sm" data-jdp id="endDate"
                                                 placeholder="ÿ™ÿßÿ±€åÿÆ ÿßŸÜÿ™Ÿáÿß€å ŸÅ€åŸÑÿ™ÿ±"></div>
                    <div class="col-auto">
                        <button class="btn btn-success btn-sm text-center" onclick="filterReportDate()">ÿßÿπŸÖÿßŸÑ ŸÅ€åŸÑÿ™ÿ±
                        </button>
                    </div>
                </div>
                <hr>
                <div class="modal-body">
                    <table class="table table-striped text-end">
                        <thead>
                        <tr>
                            <th>ÿ±ÿØ€åŸÅ</th>
                            <th style="width: 60px; white-space: nowrap">ŸÜÿßŸÖ ⁄©ÿßÿ±ÿ®ÿ±€å</th>
                            <th>⁄©ŸÑ€åÿØ</th>
                            <th>ŸÖŸÇÿØÿßÿ± ŸÇÿ®ŸÑ€å</th>
                            <th>ŸÖŸÇÿØÿßÿ± ÿ¨ÿØ€åÿØ</th>
                            <th style="width: 100px">ÿ™ÿßÿ±€åÿÆ</th>
                        </tr>
                        </thead>
                        <tbody id="tableBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="modal text-right" tabindex="-1" id="printModal" dir="rtl">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="card p-2 mx-2 mt-1">
                    <div class="row p-2">
                        <div class="col-5">
                            <label class="form-label">ÿπŸÜŸàÿßŸÜ</label>
                            <input id="printMapTitleInput" class="form-control form-control-sm" type="text"
                                   placeholder="ÿπŸÜŸàÿßŸÜ ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ">
                        </div>
                        <div class="col-5">
                            <label class="form-label">ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™</label>
                            <input id="printMapDescriptionInput" class="form-control form-control-sm" type="text"
                                   placeholder="ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™ ŸÖÿÆÿ™ÿµÿ±">
                        </div>
                        <div class="col-2">
                            <div class="btn-group" role="group">
                                <button style="margin-top: 30px" type="button"
                                        class="btn btn-sm btn-primary dropdown-toggle"
                                        data-bs-toggle="dropdown"
                                        aria-expanded="false"> ⁄ÜÿßŸæ ŸÜŸÇÿ¥Ÿá
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item text-black text-right pointerCursor"
                                           onclick="printMapToPNG()">ÿÆÿ±Ÿàÿ¨€å ÿ®ÿß ŸÅÿ±ŸÖÿ™ jpg</a>
                                    </li>
                                    </li>
                                    {#                                    <li><a class="dropdown-item text-black text-right pointerCursor"#}
                                    {#                                           onclick="printMapToPDF()">ÿÆÿ±Ÿàÿ¨€å ÿ®ÿß ŸÅÿ±ŸÖÿ™ pdf</a>#}
                                    {#                                    </li>#}
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-start">
                        <div class="mt-2" style="width: 200px; margin-right: 10px">
                            <div class="mb-3" id="searchDataPrintDiv"></div>
                        </div>
                        <div class="d-flex" id="selectedKey"></div>
                    </div>
                </div>
                <div id="mainMapPrintDiv">
                    <div class="print-frame mt-1 mb-1">
                        <div class="d-flex justify-content-between">
                            <div class="text-center">
                                <h6 id="printMapTitle">ÿπŸÜŸàÿßŸÜ ŸÜŸÇÿ¥Ÿá</h6>
                                <span id="printMapSpan">ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™ ŸÜŸÇÿ¥Ÿá</span>
                            </div>
                            <div id="newMapDetail" class="with-border"></div>
                        </div>
                        <div class="d-flex justify-content-center">
                            <div id="printMap" style="position: relative;">
                                <div class="corner-coordinates top-left" id="coord-nw"></div>
                                <div class="corner-coordinates top-right" id="coord-ne"></div>
                                <div class="corner-coordinates bottom-left" id="coord-sw"></div>
                                <div class="corner-coordinates bottom-right" id="coord-se"></div>
                            </div>

                        </div>
                        <div class="d-flex justify-content-center align-items-center mt-2">
                            <div class="d-flex justify-content-between w-75">
                                <div class="d-flex align-items-center justify-content-between w-75">
                                    <div class="d-flex align-items-center">
                                        <img src="{% static 'images/svg/north.svg' %}" alt="ÿ¢€å⁄©ŸàŸÜ ÿ¥ŸÖÿßŸÑ"
                                             style="width: 20px; height: 20px;">
                                        <span>ŸÖŸÇ€åÿßÿ≥ ŸÜŸÇÿ¥Ÿá:</span>
                                        <span id="mapPrintZoom" class="ms-2">1:50000</span>
                                    </div>
                                </div>
                                <div id="titleDiv"></div>
                            </div>
                        </div>
                        <div class="mt-2">.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade text-right" id="selectByAttributeModal" dir="rtl" tabindex="-1"
         aria-labelledby="selectByAttributeModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="selectByAttributeModalLabel">ÿßŸÜÿ™ÿÆÿßÿ® ÿ®ÿ± ÿßÿ≥ÿßÿ≥ Ÿà€å⁄ò⁄Ø€å</h5>
                </div>
                <div class="modal-body">
                    <label class="form-label" for="newLayerName">ŸÜÿßŸÖ ŸÅÿß€åŸÑ ÿ¨ÿØ€åÿØ ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ</label>
                    <input id="newLayerName" type="text" class="form-control-sm form-control mb-2">

                    <div id="filterConditions">
                        <div class="filter-condition">
                            <div class="row g-2 align-items-center">
                                <div class="col-md-2">
                                    <label for="attributeField_0" class="form-label">ŸÅ€åŸÑÿØ:</label>
                                    <select class="form-select form-select-sm attributeField" id="attributeField_0">
                                        <option value="">ÿßŸÜÿ™ÿÆÿßÿ® ŸÅ€åŸÑÿØ</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="comparisonOperator_0" class="form-label">ÿπŸÖŸÑ⁄Øÿ±:</label>
                                    <select class="form-select form-select-sm comparisonOperator"
                                            id="comparisonOperator_0">
                                        <option value="equals">ÿ®ÿ±ÿßÿ®ÿ± ÿßÿ≥ÿ™ ÿ®ÿß</option>
                                        <option value="notEquals">ŸÜÿßÿ®ÿ±ÿßÿ®ÿ± ÿßÿ≥ÿ™ ÿ®ÿß</option>
                                        <option value="greaterThan">ÿ®ÿ≤ÿ±⁄Øÿ™ÿ± ÿßÿ≤</option>
                                        <option value="lessThan">⁄©Ÿà⁄Ü⁄©ÿ™ÿ± ÿßÿ≤</option>
                                        <option value="contains">ÿ¥ÿßŸÖŸÑ ŸÖ€å‚Äåÿ¥ŸàÿØ</option>
                                        <option value="startsWith">ÿ¥ÿ±Ÿàÿπ ŸÖ€å‚Äåÿ¥ŸàÿØ ÿ®ÿß</option>
                                        <option value="endsWith">ÿ™ŸÖÿßŸÖ ŸÖ€å‚Äåÿ¥ŸàÿØ ÿ®ÿß</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="attributeValue_0" class="form-label">ŸÖŸÇÿØÿßÿ±:</label>
                                    <div class="input-group" dir="ltr">
                                        <button class="btn btn-sm btn-secondary dropdown-toggle" type="button"
                                                data-bs-toggle="dropdown" aria-expanded="false">
                                            ÿßŸÜÿ™ÿÆÿßÿ®
                                        </button>
                                        <ul style="max-height: 300px; overflow-y: auto;"
                                            class="dropdown-menu dropdown-menu-end text-end" id="allNewValueToSelect_0">
                                        </ul>
                                        <input type="text" class="form-control form-select-sm attributeValue"
                                               id="attributeValue_0"
                                               placeholder="ŸÖÿ™ŸÜ ÿ¨ÿ≥ÿ™ÿ¨Ÿà...">
                                    </div>
                                </div>
                                <div class="col-md-2 mt-4 d-flex align-items-end justify-content-end">
                                    <button type="button" class="btn btn-sm btn-danger remove-condition"
                                            style="display:none;">
                                        ÿ≠ÿ∞ŸÅ
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button type="button" class="btn btn-sm btn-success mt-2" id="addFilterCondition">ÿßŸÅÿ≤ŸàÿØŸÜ ÿ¥ÿ±ÿ∑
                    </button>

                    <div class="alert alert-info mt-3 p-2">
                        <strong>ŸÜ⁄©ÿ™Ÿá:</strong> ÿ®ÿ±ÿß€å Ÿáÿ± ÿ¥ÿ±ÿ∑ ÿ¨ÿØ€åÿØ ŸÖ€å‚Äåÿ™ŸàÿßŸÜ€åÿØ ÿ™ÿ±⁄©€åÿ® ŸÖŸÜÿ∑ŸÇ€å (Ÿà / €åÿß) ÿ®ÿß ÿ¥ÿ±ÿ∑ ŸÇÿ®ŸÑ€å ÿ±ÿß ÿßŸÜÿ™ÿÆÿßÿ®
                        ⁄©ŸÜ€åÿØ.
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ®ÿ≥ÿ™ŸÜ</button>
                    <button type="button" class="btn btn-primary" id="applySelection">ÿßÿπŸÖÿßŸÑ ÿßŸÜÿ™ÿÆÿßÿ®</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addNewFeatureModal" dir="rtl" tabindex="-1" aria-labelledby="addNewFeatureModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addNewFeatureModalLabel">ÿßŸÅÿ≤ŸàÿØŸÜ ŸÖŸÑ⁄© ÿ¨ÿØ€åÿØ</h5>
                </div>
                <div class="modal-body">
                    <form id="coordinatesForm">
                        {% csrf_token %}
                        <div id="polygonPointsInput">
                            <div class="row g-2 align-items-center mb-3 point-row">
                                <div class="col">
                                    <input type="number" class="form-control form-control-sm longitude-input"
                                           value="46.22" placeholder="X (ÿ∑ŸàŸÑ)" name="x[]">
                                </div>
                                <div class="col">
                                    <input type="number" class="form-control form-control-sm latitude-input"
                                           value="36.27" placeholder="Y (ÿπÿ±ÿ∂)" name="y[]">
                                </div>
                                <div class="col-auto">
                                    <button type="button" class="btn btn-danger btn-sm remove-point">ÿ≠ÿ∞ŸÅ</button>
                                </div>
                            </div>
                            <div class="row g-2 align-items-center mb-3 point-row">
                                <div class="col">
                                    <input type="number" class="form-control form-control-sm longitude-input"
                                           value="46.16" placeholder="X (ÿ∑ŸàŸÑ)" name="x[]">
                                </div>
                                <div class="col">
                                    <input type="number" class="form-control form-control-sm latitude-input"
                                           value="36.32" placeholder="Y (ÿπÿ±ÿ∂)" name="y[]">
                                </div>
                                <div class="col-auto">
                                    <button type="button" class="btn btn-danger btn-sm remove-point">ÿ≠ÿ∞ŸÅ</button>
                                </div>
                            </div>
                            <div class="row g-2 align-items-center mb-3 point-row">
                                <div class="col">
                                    <input type="number" class="form-control form-control-sm longitude-input"
                                           value="46.35" placeholder="X (ÿ∑ŸàŸÑ)" name="x[]">
                                </div>
                                <div class="col">
                                    <input type="number" class="form-control form-control-sm latitude-input"
                                           value="36.36" placeholder="Y (ÿπÿ±ÿ∂)" name="y[]">
                                </div>
                                <div class="col-auto">
                                    <button type="button" class="btn btn-danger btn-sm remove-point">ÿ≠ÿ∞ŸÅ</button>
                                </div>
                            </div>
                        </div>
                    </form>
                    <button type="button" class="btn btn-success btn-sm" id="addPoint">ÿßŸÅÿ≤ŸàÿØŸÜ ŸÜŸÇÿ∑Ÿá ÿ¨ÿØ€åÿØ</button>
                    <hr>
                    <form id="allNewFileForm">
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tmelk" name="tmelk"
                                       placeholder="ŸÜŸàÿπ ŸÖŸÑ⁄©">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="plan" name="plan"
                                       placeholder="ŸæŸÑÿßŸÜ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="vahed" name="vahed"
                                       placeholder="Ÿàÿßÿ≠ÿØ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="malek" name="malek"
                                       placeholder="ŸÖÿßŸÑ⁄©">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="onvan" name="onvan"
                                       placeholder="ÿπŸÜŸàÿßŸÜ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sakhtar" name="sakhtar"
                                       placeholder="ÿ≥ÿßÿÆÿ™ÿßÿ±">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="faliat" name="faliat"
                                       placeholder="ŸÜŸàÿπ ŸÅÿπÿßŸÑ€åÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="karbari" name="karbari"
                                       placeholder="ÿµŸÜÿπÿ™€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="vaziat" name="vaziat"
                                       placeholder="Ÿàÿ∂ÿπ€åÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ostan" name="ostan"
                                       placeholder="ÿßÿ≥ÿ™ÿßŸÜ">
                            </div>
                            <div class="col-md-6">
                            <textarea class="form-control form-control-sm" id="adres" name="adres" rows="1"
                                      placeholder="ÿ¢ÿØÿ±ÿ≥"></textarea>
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="plak" name="plak"
                                       placeholder="ŸÖÿ¥ÿÆÿµÿßÿ™ ŸæŸÑÿß⁄© ÿ´ÿ®ÿ™€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="malekiat" name="malekiat"
                                       placeholder="Ÿàÿ∂ÿπ€åÿ™ ŸÖÿßŸÑ⁄©€åÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tejare" name="tejare"
                                       placeholder="ÿ™ÿßÿ±€åÿÆ ÿßÿ¨ÿßÿ±Ÿá">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="dejare" name="dejare"
                                       placeholder="ŸÖÿ®ŸÑÿ∫ ÿØÿ±€åÿßŸÅÿ™ ÿßÿ¨ÿßÿ±Ÿá">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ttamalok" name="ttamalok"
                                       placeholder="ÿ™ÿßÿ±€åÿÆ ŸÖÿßŸÑ⁄©€åÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="pejare" name="pejare"
                                       placeholder="ŸÖÿ®ŸÑÿ∫ ÿßÿ¨ÿßÿ±Ÿá">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="ghimat_mlk"
                                       name="ghimat_mlk"
                                       placeholder="ŸÇ€åŸÖÿ™ ÿ™ŸÇÿ±€åÿ®€å ŸÖŸÑ⁄©">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="moarez" name="moarez"
                                       placeholder="ŸÖÿπÿßÿ±ÿ∂">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-12">
                            <textarea class="form-control form-control-sm" id="tmoarez" name="tmoarez" rows="1"
                                      placeholder="ÿ™Ÿàÿ∂€åÿ≠ÿßÿ™ ŸÖÿπÿßÿ±ÿ∂"></textarea>
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="madarek" name="madarek"
                                       placeholder="ŸÖÿØÿßÿ±⁄© ŸÖŸàÿ¨ŸàÿØ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_bime" name="ty_bime"
                                       placeholder="ŸÜŸàÿπ ÿ®€åŸÖŸá">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="nam_bime" name="nam_bime"
                                       placeholder="ÿ¥ÿ±⁄©ÿ™ ÿ®€åŸÖŸá">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sho_bime" name="sho_bime"
                                       placeholder="ÿ¥ŸÖÿßÿ±Ÿá ÿ®€åŸÖŸá">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="dt_ex_bime"
                                       name="dt_ex_bime"
                                       placeholder="ÿ™ÿßÿ±€åÿÆ ÿßŸÜŸÇÿ∂ÿß ÿ®€åŸÖŸá">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sh_paynkar"
                                       name="sh_paynkar"
                                       placeholder="ÿ¥ŸÖÿßÿ±Ÿá ⁄ØŸàÿßŸá€å ÿßÿ™ŸÖÿßŸÖ ÿπŸÖŸÑ€åÿßÿ™ ÿ≥ÿßÿÆÿ™ŸÖÿßŸÜ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tpaynkar" name="tpaynkar"
                                       placeholder="ÿ™ÿßÿ±€åÿÆ Ÿæÿß€åÿßŸÜ ⁄©ÿßÿ±">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="salsakht" name="salsakht"
                                       placeholder="ÿ≥ÿßŸÑ ÿ≥ÿßÿÆÿ™">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="salbana" name="salbana"
                                       placeholder="ŸÇÿØŸÖÿ™ ÿ®ŸÜÿß">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="tarakom" name="tarakom"
                                       placeholder="ÿØÿ±ÿµÿØ ÿ™ÿ±ÿß⁄©ŸÖ ÿ≥ÿßÿÆÿ™ŸÖÿßŸÜ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="sathesh" name="sathesh"
                                       placeholder="ÿ≥ÿ∑ÿ≠ ÿßÿ¥ÿ∫ÿßŸÑ">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="sarane" name="sarane"
                                       placeholder="ÿ≥ÿ±ÿßŸÜŸá ŸÜŸÅÿ± ÿØÿ± ŸÖÿ™ÿ± ŸÖÿ±ÿ®ÿπ">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="typeskelet"
                                       name="typeskelet"
                                       placeholder="ŸÜŸàÿπ ÿßÿ≥⁄©ŸÑÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="arse" name="arse"
                                       placeholder="ÿπÿ±ÿµŸá">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="aeian" name="aeian"
                                       placeholder="ÿßÿπ€åÿßŸÜ">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="msetadi" name="msetadi"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿ≥ÿ™ÿßÿØ€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="mamozeshi"
                                       name="mamozeshi"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿ¢ŸÖŸàÿ≤ÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="melmikar" name="melmikar"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿ¢ŸÖŸàÿ≤ÿ¥ ÿπŸÑŸÖ€å ⁄©ÿßÿ±ÿ®ÿ±ÿØ€å">
                            </div>
                            <div class="col-md-6">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="ma_ali" name="ma_ali"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿ¢ŸÖŸàÿ≤ÿ¥ ÿπÿßŸÑ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="ma_kotah" name="ma_kotah"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿ¢ŸÖŸàÿ≤ÿ¥ ⁄©Ÿàÿ™ÿßŸá ŸÖÿØÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_kar_a" name="m_kar_a"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ⁄©ÿßÿ±⁄ØÿßŸá ÿ¢ŸÖŸàÿ≤ÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_az_am" name="m_az_am"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿ¢ÿ≤ŸÖÿß€åÿ¥⁄ØÿßŸá ÿ¢ŸÖŸàÿ≤ÿ¥€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_pazho" name="m_pazho"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò Ÿæ⁄òŸàŸáÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_darm_p" name="m_darm_p"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿØÿ±ŸÖÿßŸÜ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_groh_p" name="m_groh_p"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ⁄Øÿ±ŸàŸá Ÿæ⁄òŸàŸáÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_mkhtakh"
                                       name="m_mkhtakh"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ŸÖÿ±⁄©ÿ≤ ÿÆÿØŸÖÿßÿ™ ÿ™ÿÆÿµÿµ€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_kar_p" name="m_kar_p"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ⁄©ÿßÿ±⁄ØÿßŸá Ÿæ⁄òŸàŸáÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_azma_p" name="m_azma_p"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿßÿ≤ ÿ¢ÿ≤ŸÖÿß€åÿ¥⁄ØÿßŸá Ÿæ⁄òŸàŸáÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_farangi"
                                       name="m_farangi"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ŸÅÿ±ŸáŸÜ⁄Ø€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_eshtegh"
                                       name="m_eshtegh"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿßÿ¥ÿ™ÿ∫ÿßŸÑ Ÿà ÿ™ÿ¨ÿßÿ±€å ÿ≥ÿßÿ≤€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_varzesh"
                                       name="m_varzesh"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò Ÿàÿ±ÿ≤ÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_eghamati"
                                       name="m_eghamati"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿßŸÇÿßŸÖÿ™€å (ÿ±ŸÅÿßŸá€å)">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_refahi" name="m_refahi"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿ±ŸÅÿßŸá€å Ÿà ÿ±ÿ≥ÿ™Ÿàÿ±ÿßŸÜ">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_anbari" name="m_anbari"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿßŸÜÿ®ÿßÿ±€å Ÿà ŸÖŸàÿ™Ÿàÿ± ÿÆÿßŸÜŸá">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_moshaat"
                                       name="m_moshaat"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿ±ÿßŸá ŸæŸÑŸá Ÿà ŸÖÿ¥ÿßÿπÿßÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_park" name="m_park"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò Ÿæÿßÿ±⁄©€åŸÜ⁄Ø">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_tasisat"
                                       name="m_tasisat"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ÿ™ÿßÿ≥€åÿ≥ÿßÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="m_golkhane"
                                       name="m_golkhane"
                                       placeholder="ŸÖÿ™ÿ±ÿß⁄ò ⁄ØŸÑÿÆÿßŸÜŸá">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="t_tabagh" name="t_tabagh"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ÿ∑ÿ®ŸÇÿßÿ™ ÿ≥ÿßÿÆÿ™ŸÖÿßŸÜ">
                            </div>
                            <div class="col-md-9">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_chah" name="te_chah"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ⁄ÜÿßŸá">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_cha_lai"
                                       name="te_cha_lai"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ⁄ÜÿßŸá ŸÑÿß€åŸá ÿ±Ÿàÿ®€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_setad" name="tab_setad"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿ≥ÿ™ÿßÿØ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_amoz" name="tab_amoz"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_am_ali"
                                       name="tab_am_ali"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥ ÿπÿßŸÑ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_elmi" name="tab_elmi"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥ ÿπŸÑŸÖ€å ⁄©ÿßÿ±ÿ®ÿ±ÿØ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_am_kot"
                                       name="tab_am_kot"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥ ⁄©Ÿàÿ™ÿßŸá ŸÖÿØÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_kar_am"
                                       name="tab_kar_am"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ⁄©ÿßÿ±⁄ØÿßŸá ÿ¢ŸÖŸàÿ≤ÿ¥€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_az_amo"
                                       name="tab_az_amo"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿ¢ÿ≤ŸÖÿß€åÿ¥⁄ØÿßŸá ÿ¢ŸÖŸàÿ≤ÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_pazh" name="tab_pazh"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ Ÿæ⁄òŸàŸáÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_darm" name="tab_darm"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿØÿ±ŸÖÿßŸÜ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_gro_pa"
                                       name="tab_gro_pa"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ⁄Øÿ±ŸàŸá Ÿæ⁄òŸàŸáÿ¥€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_mkhd_t"
                                       name="tab_mkhd_t"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ŸÖÿ±⁄©ÿ≤ ÿÆÿØŸÖÿßÿ™ ÿ™ÿÆÿµÿµ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_az_pa" name="tab_az_pa"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿ¢ÿ≤ŸÖÿß€åÿ¥⁄ØÿßŸá Ÿæ⁄òŸàŸáÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_kar_pa"
                                       name="tab_kar_pa"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ⁄©ÿßÿ±⁄ØÿßŸá Ÿæ⁄òŸàŸáÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_farang"
                                       name="tab_farang"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ŸÅÿ±ŸáŸÜ⁄Ø€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_eshteg"
                                       name="tab_eshteg"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿßÿ¥ÿ™ÿ∫ÿßŸÑ Ÿà ÿ™ÿ¨ÿßÿ±€å ÿ≥ÿßÿ≤€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_var" name="tab_var"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ Ÿàÿ±ÿ≤ÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_egh" name="tab_egh"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿßŸÇÿßŸÖÿ™€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_refah" name="tab_refah"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿ±ŸÅÿßŸá€å Ÿà ÿ±ÿ≥ÿ™Ÿàÿ±ÿßŸÜ">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_anbar" name="tab_anbar"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿßŸÜÿ®ÿßÿ±€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_mosh" name="tab_mosh"
                                       placeholder="ÿ±ÿßŸá ŸæŸÑŸá Ÿà ŸÖÿ¥ÿßÿπÿßÿ™">
                            </div>
                            <div class="col-md-6">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_park" name="tab_park"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ Ÿæÿßÿ±⁄©€åŸÜ⁄Ø">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tab_tasis" name="tab_tasis"
                                       placeholder="ÿ∑ÿ®ŸÇÿßÿ™ ÿ™ÿßÿ≥€åÿ≥ÿßÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_masale" name="ty_masale"
                                       placeholder="ŸÜŸàÿπ ŸÖÿµÿßŸÑÿ≠">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="mas_div_ot"
                                       name="mas_div_ot"
                                       placeholder="ŸÖÿµÿßŸÑÿ≠ ŸÖÿµÿ±ŸÅ€å ÿØ€åŸàÿßÿ±Ÿáÿß€å ÿÆÿßÿ±ÿ¨€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="mas_div_in"
                                       name="mas_div_in"
                                       placeholder="ŸÖÿµÿßŸÑÿ≠ ŸÖÿµÿ±ŸÅ€å ÿØ€åŸàÿßÿ±Ÿáÿß€å ÿØÿßÿÆŸÑ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="nama_ot" name="nama_ot"
                                       placeholder="ŸÜŸÖÿßŸáÿß€å ÿÆÿßÿ±ÿ¨€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="posh_bam" name="posh_bam"
                                       placeholder="ŸæŸàÿ¥ÿ¥ ŸÜŸáÿß€å€å ÿ®ÿßŸÖ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="pangere" name="pangere"
                                       placeholder="ŸæŸÜÿ¨ÿ± Ÿáÿß">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="kafrah" name="kafrah"
                                       placeholder="⁄©ŸÅ ÿ±ÿßŸá ŸæŸÑŸá">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_shishe" name="ty_shishe"
                                       placeholder="ŸÜŸàÿπ ÿ¥€åÿ¥Ÿá">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="aigh_rdi_o"
                                       name="aigh_rdi_o"
                                       placeholder="ÿπÿß€åŸÇ ÿ±ÿ∑Ÿàÿ®ÿ™€å ÿØ€åŸàÿßÿ±Ÿáÿß€å ÿÆÿßÿ±ÿ¨€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="aigh_h_kaf"
                                       name="aigh_h_kaf"
                                       placeholder="ÿπÿß€åŸÇ ÿ≠ÿ±ÿßÿ±ÿ™€å ⁄©ŸÅ">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="aigh_h_sag"
                                       name="aigh_h_sag"
                                       placeholder="ÿπÿß€åŸÇ ÿ≠ÿ±ÿßÿ±ÿ™€å ÿ≥ŸÇŸÅ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="aigh_hdi_o"
                                       name="aigh_hdi_o"
                                       placeholder="ÿπÿß€åŸÇ ÿ≠ÿ±ÿßÿ±ÿ™€å ÿØ€åŸàÿßÿ±ŸáŸáÿß€å ÿÆÿßÿ±ÿ¨€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sys_tabgh" name="sys_tabgh"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ÿØÿ≥ÿ™ÿ±ÿ≥€å ÿ®Ÿá ÿ∑ÿ®ŸÇÿßÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_khak" name="ty_khak"
                                       placeholder="ŸÜŸàÿπ ÿÆÿß⁄©">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_pay" name="ty_pay"
                                       placeholder="ŸÜŸàÿπ Ÿæ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_saghf" name="ty_saghf"
                                       placeholder="ŸÜŸàÿπ ÿ≥ŸÇŸÅ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="di_saghf" name="di_saghf"
                                       placeholder="ÿØ€åŸàÿßÿ± ÿ≠ÿßÿ¶ŸÑ ÿ≤€åÿ± ÿ≥ŸÇŸÅ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_lol_ab" name="ty_lol_ab"
                                       placeholder="ŸÜŸàÿπ ŸÑŸàŸÑŸá ŸÖÿµÿ±ŸÅ€å ÿ¢ÿ®">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_lol_faz"
                                       name="ty_lol_faz"
                                       placeholder="ŸÜŸàÿπ ŸÑŸàŸÑŸá ŸÖÿµÿ±ŸÅ€å ŸÅÿßÿ∂ŸÑÿßÿ®">
                            </div>
                            <div class="col-md-9">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_lol_gs" name="ty_lol_gs"
                                       placeholder="ŸÜŸàÿπ ŸÑŸàŸÑŸá ŸÖÿµÿ±ŸÅ€å ⁄Øÿ±ŸÖÿß€åÿ¥ Ÿà ÿ≥ÿ±ŸÖÿß€åÿ¥">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_lol_gaz"
                                       name="ty_lol_gaz"
                                       placeholder="ŸÜŸàÿπ ŸÑŸàŸÑŸá ŸÖÿµÿ±ŸÅ€å ⁄Øÿßÿ≤">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_sokht" name="ty_sokht"
                                       placeholder="ŸÜŸàÿπ ÿ≥ŸàÿÆÿ™ ŸÖÿµÿ±ŸÅ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sys_grm" name="sys_grm"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ⁄Øÿ±ŸÖÿß€åÿ¥€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sys_sarma" name="sys_sarma"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ÿ≥ÿ±ŸÖÿß€åÿ¥">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sys_entg_d"
                                       name="sys_entg_d"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ÿßŸÜÿ™ŸÇÿßŸÑ ⁄Øÿ±ŸÖÿß Ÿà ÿ≥ÿ±ŸÖÿß">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sys_daf_fa"
                                       name="sys_daf_fa"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ÿØŸÅÿπ ŸÅÿßÿ∂ŸÑÿßÿ®">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sys_atash" name="sys_atash"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ÿ¢ÿ™ÿ¥ŸÜÿ¥ÿßŸÜ€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_riz_ats"
                                       name="ty_riz_ats"
                                       placeholder="ŸÜŸàÿπ ÿ±ÿß€åÿ≤ ÿ≥€åÿ≥ÿ™ŸÖ ÿ¢ÿ™ÿ¥ŸÜÿ¥ÿßŸÜ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="dak_servis"
                                       name="dak_servis"
                                       placeholder="ÿØÿß⁄©ÿ™ ŸÇÿßÿ®ŸÑ ÿ≥ÿ±Ÿà€åÿ≥">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sy_con_tas"
                                       name="sy_con_tas"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ŸáŸàÿ¥ŸÖŸÜÿØ ⁄©ŸÜÿ™ÿ±ŸÑ ÿ™ÿßÿ≥€åÿ≥ÿßÿ™">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="makh_abats"
                                       name="makh_abats"
                                       placeholder="ŸÖÿ∫ÿ≤ŸÜ ÿ¢ÿ® ÿ¨Ÿáÿ™ ÿ≥€åÿ≥ÿ™ŸÖ ÿ¢ÿ™ÿ¥ŸÜÿ¥ÿßŸÜ€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="taj_atsh" name="taj_atsh"
                                       placeholder="ÿ™ÿ¨Ÿá€åÿ≤ÿßÿ™ ÿßÿ±ÿ™ŸÅÿßÿπ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ser_dore" name="ser_dore"
                                       placeholder="ÿ≥ÿ±Ÿà€åÿ≥ ÿØŸàÿ±Ÿá ÿß€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="dt_ser_dor"
                                       name="dt_ser_dor"
                                       placeholder="ÿ™ÿßÿ±€åÿÆ ÿ≥ÿ±Ÿà€åÿ≥ ÿØŸàÿ±Ÿá ÿß€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="egzast" name="egzast"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ÿß⁄Øÿ≤ÿßÿ≥ÿ™">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_asan" name="ty_asan"
                                       placeholder="ŸÜŸàÿπ ÿ¢ÿ≥ÿßŸÜÿ≥Ÿà">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_asan" name="te_asan"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ÿ¢ÿ≥ÿßŸÜÿ≥Ÿàÿ±">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="zarf_asan" name="zarf_asan"
                                       placeholder="ÿ∏ÿ±ŸÅ€åÿ™ ÿ¢ÿ≥ÿßŸÜÿ≥Ÿàÿ±">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tasis_jan" name="tasis_jan"
                                       placeholder="ÿ™ÿßÿ≥€åÿ≥ÿßÿ™ ÿ¨ÿßŸÜÿ®€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="lole_goz" name="lole_goz"
                                       placeholder="ŸÑŸàŸÑŸá ⁄Øÿ∞ÿßÿ±€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_roshan" name="ty_roshan"
                                       placeholder="ŸÖÿ¥ÿÆÿµÿßÿ™ ÿ≥€åÿ≥ÿ™ŸÖ ÿ±Ÿàÿ¥ŸÜÿß€å€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="madar_brgh"
                                       name="madar_brgh"
                                       placeholder="ŸÖÿØÿßÿ± ÿ±Ÿàÿ¥ŸÜÿß€å€å Ÿà Ÿæÿ±€åÿ≤">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sys_erth" name="sys_erth"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ÿßÿ™ÿµÿßŸÑ ÿ≤ŸÖ€åŸÜ">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sy_elam_ha"
                                       name="sy_elam_ha"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ÿßÿπŸÑÿßŸÖ ÿ≠ÿ±€åŸÇ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sys_darb" name="sys_darb"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ÿ®ÿßÿ≤ÿ¥Ÿà ÿØÿ±ÿ® ŸÖÿßÿ¥€åŸÜ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sys_tel" name="sys_tel"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ÿ™ŸÑŸÅŸÜ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sys_ups" name="sys_ups"
                                       placeholder="ÿ≥€åÿ≥ÿ™ŸÖ ÿ®ÿ±ŸÇ ÿßÿ∂ÿ∑ÿ±ÿßÿ±€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="tavan_ups" name="tavan_ups"
                                       placeholder="ŸÇÿØÿ±ÿ™ ÿ≥€åÿ≥ÿ™ŸÖ ÿ®ÿ±ŸÇ ÿßÿ∂ÿ∑ÿ±ÿßÿ±€å€å">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sh_esh_ab" name="sh_esh_ab"
                                       placeholder="ÿ¥ŸÖÿßÿ±Ÿá ÿßÿ¥ÿ™ÿ±ÿß⁄© ÿ¢ÿ®">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sh_esh_brg"
                                       name="sh_esh_brg"
                                       placeholder="ÿ¥ŸÖÿßÿ±Ÿá ÿßÿ¥ÿ™ÿ±ÿß⁄© ÿ®ÿ±ŸÇ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sh_esh_gaz"
                                       name="sh_esh_gaz"
                                       placeholder="ÿ¥ŸÖÿßÿ±Ÿá ÿßÿ¥ÿ™ÿ±ÿß⁄© ⁄Øÿßÿ≤">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_con_ab" name="ty_con_ab"
                                       placeholder="ŸÜŸàÿπ ⁄©ŸÜÿ™Ÿàÿ± ÿ¢ÿ®">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="zar_con_ab"
                                       name="zar_con_ab"
                                       placeholder="ÿ∏ÿ±ŸÅ€åÿ™ ⁄©ŸÜÿ™Ÿàÿ± ÿ¢ÿ®">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_con_brg"
                                       name="ty_con_brg"
                                       placeholder="ŸÜŸàÿπ ⁄©ŸÜÿ™Ÿàÿ± ÿ®ÿ±ŸÇŸá">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="zr_con_brg"
                                       name="zr_con_brg"
                                       placeholder="ÿ∏ÿ±ŸÅ€åÿ™ ⁄©ŸÜÿ™Ÿàÿ± ÿ®ÿ±ŸÇ">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="ty_con_gaz"
                                       name="ty_con_gaz"
                                       placeholder="ŸÜŸàÿπ ⁄©ŸÜÿ™Ÿàÿ± ⁄Øÿßÿ≤">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="zr_con_gaz"
                                       name="zr_con_gaz"
                                       placeholder="ÿ∏ÿ±ŸÅ€åÿ™ ⁄©ŸÜÿ™Ÿàÿ± ⁄Øÿßÿ≤">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="taj_sakht" name="taj_sakht"
                                       placeholder="ÿ™ÿ¨Ÿá€åÿ≤ÿßÿ™ ÿ≥ÿßÿÆÿ™ŸÖÿßŸÜ">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_chiler"
                                       name="te_chiler"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ⁄Ü€åÿ±">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_brj_srd"
                                       name="te_brj_srd"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ÿ®ÿ±ÿ¨ ÿÆŸÜ⁄© ⁄©ŸÜŸÜÿØŸá">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_col_ab"
                                       name="te_col_ab"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ⁄©ŸàŸÑÿ± ÿ¢ÿ®€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_col_gaz"
                                       name="te_col_gaz"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ⁄©ŸàŸÑÿ± ⁄Øÿßÿ≤€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_boilr" name="te_boilr"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ÿ®Ÿà€åŸÑÿ±">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_bokhari"
                                       name="te_bokhari"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ÿ®ÿÆÿßÿ±€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_shomine"
                                       name="te_shomine"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ÿ¥ŸàŸÖ€åŸÜŸá ⁄Øÿßÿ≤€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_pakig" name="te_pakig"
                                       placeholder="ÿ™ÿπÿØÿßÿØ Ÿæ⁄©€åÿ¨">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_skht_ab"
                                       name="te_skht_ab"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ÿ≥ÿÆÿ™€å ⁄Ø€åÿ±">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_pomp_ab"
                                       name="te_pomp_ab"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ŸæŸÖŸæ ÿ¢ÿ®ÿ±ÿ≥ÿßŸÜ€å">
                            </div>
                            <div class="col-md-9">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_radiato"
                                       name="te_radiato"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ÿ±ÿßÿØ€åÿßÿ™Ÿàÿ±">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_fan_col"
                                       name="te_fan_col"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ŸÅŸÜ ⁄©Ÿàÿ¶ŸÑ">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_makh_at"
                                       name="te_makh_at"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ŸÖÿÆÿßÿ≤ŸÜ ÿ∞ÿÆ€åÿ±Ÿá ÿ¢ÿ® ÿ¢ÿ™ÿ¥ŸÜÿ¥ÿßŸÜ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_makh_ab"
                                       name="te_makh_ab"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ŸÖÿÆÿßÿ≤ŸÜ ÿ∞ÿÆ€åÿ±Ÿá ÿ¢ÿ®">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_zhnratr"
                                       name="te_zhnratr"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ⁄òŸÜÿ±ÿßÿ™Ÿàÿ± ÿßÿ∂ÿ∑ÿ±ÿßÿ±€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_dzlatsh"
                                       name="te_dzlatsh"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ÿØ€åÿ≤ŸÑ ŸæŸÖŸæ ÿ¢ÿ™ÿ¥ŸÜÿ¥ÿßŸÜ€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_pak_col"
                                       name="te_pak_col"
                                       placeholder="ÿ™ÿπÿØÿßÿØ Ÿæ⁄©€åÿ¨ ŸáŸàÿß€å€å ÿ≥ÿ±ŸÖÿß€åÿ¥€å">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_hava_sz"
                                       name="te_hava_sz"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ŸáŸàÿßÿ≥ÿßÿ≤">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_manb_ab"
                                       name="te_manb_ab"
                                       placeholder=" ÿ™ÿπÿØÿßÿØ ŸÖŸÜÿßÿ®ÿπ ÿ¢ÿ® ⁄Øÿ±ŸÖ">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_otg_srv"
                                       name="te_otg_srv"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ÿßÿ™ÿßŸÇ ÿ≥ÿ±Ÿàÿ±">
                            </div>
                            <div class="col-md-3">
                                <input type="number" class="form-control form-control-sm" id="te_otg_tel"
                                       name="te_otg_tel"
                                       placeholder="ÿ™ÿπÿØÿßÿØ ÿßÿ™ÿßŸÇ ŸÖÿ±⁄©ÿ≤ ÿ™ŸÑŸÅŸÜ">
                            </div>
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="marker" name="marker"
                                       placeholder="⁄©ÿØ Ÿæÿ≥ÿ™€å">
                            </div>
                        </div>
                        <div class="row mb-1">
                            <div class="col-md-3">
                                <input type="text" class="form-control form-control-sm" id="sardar" name="sardar"
                                       placeholder="ŸÑ€åŸÜ⁄© ÿ≥ÿ±ÿØÿ±">
                            </div>
                            <div class="col-md-9">
                                <input type="text" class="form-control form-control-sm" id="mostanadat"
                                       name="mostanadat"
                                       placeholder="ŸÖÿ≥ÿ™ŸÜÿØÿßÿ™">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ®ÿ≥ÿ™ŸÜ</button>
                    <button class="btn btn-success"
                            onclick="addNewFeature()">ÿ∞ÿÆ€åÿ±Ÿá
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="renameLayer" dir="rtl" tabindex="-1" aria-labelledby="renameLayerLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="renameLayerLabel">ÿ™ÿ∫€å€åÿ± ŸÜÿßŸÖ ŸÑÿß€åŸá</h5>
                </div>
                <div class="modal-body" id="renameModalBody">

                </div>
                <div class="modal-footer">
                    <div id="renameModalFooter"></div>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ®ÿ≥ÿ™ŸÜ</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="ClassifyModal" dir="rtl" tabindex="-1" aria-labelledby="ClassifyModalModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header justify-content-between align-items-center">
                    <h5 class="modal-title" id="documentsModalLabel">ÿØÿ≥ÿ™Ÿá ÿ®ŸÜÿØ€å ÿßŸÖŸÑÿß⁄©</h5>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">‚úñ</button>
                </div>
                <div class="modal-body">
                    <div>
                        <label for="classifyField">ÿßŸÜÿ™ÿÆÿßÿ® ŸÅ€åŸÑÿØ ÿ®ÿ±ÿß€å ÿØÿ≥ÿ™Ÿá‚Äåÿ®ŸÜÿØ€å:</label>
                        <select class="form-control" id="classifyField">
                            <option value="arse">ÿπÿ±ÿµŸá</option>
                            <option value="aeian">ÿßÿπ€åÿßŸÜ</option>
                            <option value="salbana">ŸÇÿØŸÖÿ™ ÿ®ŸÜÿß</option>
                        </select>
                    </div>
                    <div id="categoryRanges">
                        <label>ÿ™ÿπÿ±€åŸÅ ÿ®ÿßÿ≤Ÿá‚ÄåŸáÿß€å ÿØÿ≥ÿ™Ÿá‚Äåÿ®ŸÜÿØ€å ÿ®ÿ±ÿß€å ŸÅ€åŸÑÿØ <span id="selectedFieldName"></span>:</label>
                        <div class="input-group mb-2">
                            <input type="number" class="form-control" placeholder="ÿßÿ≤">
                            <div class="input-group-prepend mx-1">
                                <span class="input-group-text">ÿ™ÿß</span>
                            </div>
                            <input type="number" class="form-control" placeholder="ÿ™ÿß">
                            <div class="input-group-append">
                                <button class="btn btn-success add-range" type="button">+</button>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary mt-3" id="classifyButton">ÿØÿ≥ÿ™Ÿá‚Äåÿ®ŸÜÿØ€å</button>
                    <div id="classificationResults" class="mt-3">
                    </div>
                    <div id="mainCanvasDiv" class="card p-2 m-2">
                        <canvas id="classificationChart"
                                style="display: none; max-width: 100%; width: 100%; height: auto;"></canvas>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-info" id="showChartButton">ŸÜŸÖÿß€åÿ¥ ŸÜŸÖŸàÿØÿßÿ±</button>
                    <button type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal">ÿ®ÿ≥ÿ™ŸÜ</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="documentsModal" dir="rtl" tabindex="-1" aria-labelledby="documentsModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header justify-content-between align-items-center">
                    <h5 class="modal-title" id="documentsModalLabel">ŸáŸÖŸá ŸÖÿ≥ÿ™ŸÜÿØÿßÿ™</h5>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">‚úñ</button>
                </div>
                <div class="modal-body">
                    <input type="text" id="docSearch" class="form-control mb-3" placeholder="ÿ¨ÿ≥ÿ™ÿ¨Ÿà ÿØÿ± ŸÖÿ≥ÿ™ŸÜÿØÿßÿ™...">
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover text-center" id="docTable">
                            <thead class="table-light">
                            <tr>
                                <th>ÿ±ÿØ€åŸÅ</th>
                                <th>ŸÜÿßŸÖ ŸÖÿ≥ÿ™ŸÜÿØ</th>
                                <th>ÿπŸÜŸàÿßŸÜ</th>
                                <th>Ÿàÿßÿ≠ÿØ</th>
                                <th>ÿ™ÿßÿ±€åÿÆ</th>
                                <th>ÿ¢ŸæŸÑŸàÿØ⁄©ŸÜŸÜÿØŸá</th>
                                <th>ÿØÿßŸÜŸÑŸàÿØ</th>
                            </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ®ÿ≥ÿ™ŸÜ</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="mainDocumentModal" dir="rtl" tabindex="-1" aria-labelledby="mainDocumentModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header justify-content-between align-items-center">
                    <h5 class="modal-title" id="mainDocumentModalLabel">ŸáŸÖŸá Ÿàÿßÿ≠ÿØŸáÿß</h5>
                    <button type="button" class="btn btn-danger" id="closeMainDocumentModal" data-bs-dismiss="modal">‚úñ
                    </button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <input type="text" class="form-control" id="searchInput" placeholder="ÿ¨ÿ≥ÿ™ÿ¨Ÿà ÿØÿ± ÿ¨ÿØŸàŸÑ...">
                    </div>
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover text-center" id="unitTable">
                            <thead class="table-light">
                            <tr>
                                <th>ÿ±ÿØ€åŸÅ</th>
                                <th>ŸÜÿßŸÖ Ÿàÿßÿ≠ÿØ</th>
                                <th>ÿßÿ≥ÿ™ÿßŸÜ</th>
                                <th>ŸÜŸÖÿß€åÿ¥</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for vahed in vahedNames %}
                                <tr class="text-right">
                                    <td>{{ forloop.counter }}</td>
                                    <td>{{ vahed.name }}</td>
                                    <td>{{ vahed.ostan }}</td>
                                    <td><a class="pointerCursor"
                                           onclick="searchDocuments('{{ vahed.name }}', '{{ vahed.ostan }}')">ŸÜŸÖÿß€åÿ¥
                                        ŸáŸÖŸá</a></td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ®ÿ≥ÿ™ŸÜ</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="CommentModal" dir="rtl" tabindex="-1"
         aria-labelledby="CommentModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header justify-content-between align-items-center">
                    <h5 class="modal-title" id="searchedDocumentsModalLabel">⁄©ÿßŸÖŸÜÿ™ ÿ´ÿ®ÿ™ ÿ¥ÿØŸá</h5>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">‚úñ</button>
                </div>
                <div class="modal-body">
                    <h5>€åÿßÿØÿØÿßÿ¥ÿ™ ÿπŸÖŸàŸÖ€å</h5>
                    <div id="commentModalBody"></div>
                    <div id="commentModalFooter"></div>
                    <h5 class="mt-2">€åÿßÿØÿØÿßÿ¥ÿ™ ÿ¥ÿÆÿµ€å</h5>
                    <div id="OwnerCommentModalBody"></div>
                    <div id="ownerCommentModalFooter"></div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal">ÿ®ÿ≥ÿ™ŸÜ</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="searchDocumentsModal" dir="rtl" tabindex="-1"
         aria-labelledby="searchDocumentsModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header justify-content-between align-items-center">
                    <h5 class="modal-title" id="searchedDocumentsModalLabel">ŸáŸÖŸá ŸÖÿ≥ÿ™ŸÜÿØÿßÿ™</h5>
                    <div class="d-flex">
                        <button type="button" class="btn btn-success" data-bs-toggle="modal"
                                data-bs-target="#uploadDocumentModal">ÿ≥ŸÜÿØ ÿ¨ÿØ€åÿØ
                        </button>
                        <button type="button" class="btn btn-danger" style="margin-right: 5px" data-bs-dismiss="modal">
                            ‚úñ
                        </button>
                    </div>
                </div>
                <div class="modal-body">
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th scope="col">ÿ¥ŸÖÿßÿ±Ÿá</th>
                            <th scope="col">ŸÜÿßŸÖ ŸÅÿß€åŸÑ</th>
                            <th scope="col">ŸÜÿßŸÖ Ÿàÿßÿ≠ÿØ</th>
                            <th scope="col">ÿπŸÜŸàÿßŸÜ</th>
                            <th scope="col">⁄©ÿßÿ±ÿ®ÿ±</th>
                            <th scope="col">ÿ™ÿßÿ±€åÿÆ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å</th>
                            <th scope="col">ŸÜŸÖÿß€åÿ¥</th>
                        </tr>
                        </thead>
                        <tbody id="searchDocumentTableBody">
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ®ÿ≥ÿ™ŸÜ</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="documentsDetailModal" dir="rtl" tabindex="-1"
         aria-labelledby="documentsDetailModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header justify-content-between align-items-center">
                    <h5 class="modal-title" id="documentsDetailModalLabel">ÿ¨ÿ≤ÿ¶€åÿßÿ™ ŸÖÿ≥ÿ™ŸÜÿØÿßÿ™</h5>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">‚úñ</button>
                </div>
                <div class="modal-body">
                    <div class="card">
                        <div class="card-header" id="documentDetailHeader">
                        </div>
                        <div class="card-body" id="documentDetailBody">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ®ÿ≥ÿ™ŸÜ</button>
                    <a id="downloadDcoumentId" class="btn btn-success">ÿØÿßŸÜŸÑŸàÿØ ŸÅÿß€åŸÑ</a>
                </div>
            </div>
        </div>
    </div>

    <div class="offcanvas offcanvas-start resizable" data-bs-backdrop="false" tabindex="-1" id="rightOffCanvas"
         aria-labelledby="offcanvasExampleLabel">
        <div class="d-flex justify-content-between p-3">
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            <h5 class="offcanvas-title" id="leftCanvasHeader"></h5>
        </div>
        <div class="mt-1" id="leftCanvasBody" dir="rtl">
        </div>
        <div class="resizer"></div>
    </div>

    <div class="offcanvas offcanvas-start" data-bs-backdrop="false" style="width: 300px" tabindex="-1"
         id="layersOffCanvas"
         aria-labelledby="layersOffCanvas">
        <div class="d-flex justify-content-between p-3">
            <button id="closeLayerButton" type="button" class="btn-close" data-bs-dismiss="offcanvas"
                    aria-label="Close"></button>
            <h5 class="offcanvas-title" id="layersCanvasHeader"></h5>
        </div>
        <div class="mt-1" id="layersCanvasBody" dir="rtl">
        </div>
    </div>

    <div class="offcanvas offcanvas-bottom" data-bs-backdrop="false" tabindex="-1" id="attributeTableOffCanvas"
         style="height: 300px;"
         aria-labelledby="attributeTableOffCanvasLabel" data-bs-target="#staticBackdrop" aria-controls="staticBackdrop">
        <div class="resize-div" style="background-color: transparent; cursor: ns-resize;"></div>
        <div class="d-flex px-3">
            <button type="button" class="btn-close me-auto" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            <h5 id="attributeTableOffCanvasLabel">ÿ¨ÿØŸàŸÑ ÿ™Ÿàÿµ€åŸÅ€å</h5>
        </div>
        <div class="d-flex justify-content-between align-items-center px-3 mb-1" dir="rtl">
            <div class="col-md-4 text-end">
                <div class="input-group">
                    <input type="text" id="searchInput" class="form-control form-control-sm rounded"
                           placeholder="ÿπÿ®ÿßÿ±ÿ™ ŸÖŸàÿ±ÿØ ŸÜÿ∏ÿ± ÿ±ÿß ÿ¨ÿ≥ÿ™ÿ¨Ÿà ⁄©ŸÜ€åÿØ...">
                    <button id="prevBtn" class="btn btn-sm btn-warning rounded">ŸÇÿ®ŸÑ€å</button>
                    <button id="nextBtn" class="btn btn-sm btn-primary rounded">ÿ®ÿπÿØ€å</button>
                </div>
            </div>
            <div class="col-md-4 d-flex text-start justify-content-end">
                <div class="dropdown">
                    <button class="btn btn-sm btn-secondary dropdown-toggle" type="button" id="columnDropdown"
                            data-bs-toggle="dropdown" aria-expanded="false">
                        ÿ≥ÿ™ŸàŸÜ‚ÄåŸáÿß ÿ±ÿß ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ
                    </button>
                    <div class="dropdown-menu p-3" style="max-height: 300px; overflow-y: auto;"
                         aria-labelledby="columnDropdown">
                        <input type="text" id="dropdownSearch" class="form-control form-control-sm mb-3"
                               placeholder="ÿ¨ÿ≥ÿ™ÿ¨Ÿà ⁄©ŸÜ€åÿØ...">
                        <ul id="columnsMenu" class="list-unstyled">
                        </ul>
                    </div>
                </div>
                <button id="exportToExcel" class="btn btn-sm btn-success mx-1">ÿÆÿ±Ÿàÿ¨€å ÿß⁄©ÿ≥ŸÑ</button>
                <button id="showFilterInMap" class="btn btn-sm btn-primary">ŸÜŸÖÿß€åÿ¥ ÿØÿ± ŸÜŸÇÿ¥Ÿá</button>
            </div>
        </div>
        <div id="activeFiltersContainer" class="px-2" style="margin-bottom: 10px;
         display: flex; flex-wrap: wrap; gap: 10px;"></div>
        <div class="offcanvas-body py-0 mt-0" dir="rtl">
            <table class="table table-bordered table-hover table-wrapper">
                <thead id="geojson-table-head" class="table-dark sticky-top" style="z-index: 1">
                </thead>
                <tbody id="geojson-table-body">
                </tbody>
            </table>
            <div class="text-center mt-2">
                <button id="loadMoreBtn" class="btn btn-primary">ÿ®ÿßÿ±⁄Øÿ≤ÿßÿ±€å ÿ®€åÿ¥ÿ™ÿ±</button>
            </div>
        </div>
    </div>

    <div class="modal fade" dir="rtl" id="uploadDocumentModal" tabindex="-1" aria-labelledby="uploadDocumentModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header d-flex justify-content-between">
                    <h5 class="modal-title" id="uploadDocumentModalLabel">ÿ¢ŸæŸÑŸàÿØ ŸÅÿß€åŸÑ ÿ¨ÿØ€åÿØ</h5>
                    <button type="button" id="closeUploadDocument" class="btn-close" data-bs-dismiss="modal"
                            aria-label="ÿ®ÿ≥ÿ™ŸÜ"></button>
                </div>
                <div class="modal-body">
                    <form id="uploadForm">
                        <div class="mb-3">
                            <label for="fileTitle" class="form-label">ÿπŸÜŸàÿßŸÜ ŸÅÿß€åŸÑ</label>
                            <input type="text" class="form-control" id="fileTitle" name="title" required>
                        </div>
                        <div class="mb-3">
                            <label for="fileInput" class="form-label">ÿßŸÜÿ™ÿÆÿßÿ® ŸÅÿß€åŸÑ</label>
                            <input class="form-control" type="file" id="fileInput" name="file"
                                   accept=".jpg,.jpeg,.png,.pdf,.zip" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ®ÿ≥ÿ™ŸÜ</button>
                    <button type="submit" class="btn btn-success" onclick="uploadDocument()">ÿ¢ŸæŸÑŸàÿØ</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" dir="rtl" id="approveChangeModal" tabindex="-1" aria-labelledby="approveChangeModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header d-flex justify-content-between">
                    <h5 class="modal-title" id="uploadDocumentModalLabel">ÿ™ÿß€å€åÿØ ÿßÿ∑ŸÑÿßÿπÿßÿ™ Ÿà€åÿ±ÿß€åÿ¥ ÿ¥ÿØŸá</h5>
                    <button type="button" id="closeUploadDocument" class="btn-close" data-bs-dismiss="modal"
                            aria-label="ÿ®ÿ≥ÿ™ŸÜ"></button>
                </div>
                <div class="modal-body">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>#</th>
                            <th style="width: 7%">ÿßÿ≥ÿ™ÿßŸÜ</th>
                            <th style="width: 10%" scope="col">Ÿàÿßÿ≠ÿØ</th>
                            <th scope="col">ÿπŸÜŸàÿßŸÜ</th>
                            <th scope="col">⁄©ŸÑ€åÿØ</th>
                            <th scope="col">ŸÖŸÇÿØÿßÿ± ŸÇÿ®ŸÑ€å</th>
                            <th scope="col">ŸÖŸÇÿØÿßÿ± ÿ¨ÿØ€åÿØ</th>
                            <th scope="col">⁄Øÿ≤€åŸÜŸá Ÿáÿß</th>
                        </tr>
                        </thead>
                        <tbody id="changeTableBody">
                        {% for change in update %}
                            <tr id="changeTr{{ change.id }}">
                            <th scope="row">{{ forloop.counter }}</th>
                            <td>{{ change.ostan }}</td>
                            <td>{{ change.vahed }}</td>
                            <td>{{ change.onvan }}</td>
                            <td>{{ change.persian_key }}</td>
                            <td>{{ change.old_value }}</td>
                            <td>{{ change.new_value }}</td>
                            <td>
                                <div class="d-flex">
                                    <img width="20px" src="{% static 'images/new/190411.png' %}"
                                         alt="ÿ™ÿß€å€åÿØ" title="ÿ™ÿß€å€åÿØ ÿßÿ∑ŸÑÿßÿπÿßÿ™" class="pointerCursor me-2"
                                         onclick="approveUpdate({{ change.id }})">
                                    <img width="20px" src="{% static 'images/new/1214428.png' %}"
                                         alt="ÿ≠ÿ∞ŸÅ" title="ÿ≠ÿ∞ŸÅ ÿßÿ∑ŸÑÿßÿπÿßÿ™" class="pointerCursor mx-1"
                                         onclick="deleteUpdate({{ change.id }})">
                                </div>
                            </td>
                        {% endfor %}
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÿ®ÿ≥ÿ™ŸÜ</button>
                </div>
            </div>
        </div>
    </div>
    <div id="loader-wrapper"
         style="position: fixed; top:0; left:0; width:100%; height:100%; background:transparent; z-index:9999; display:flex; justify-content:center; align-items:center;">
        <div class="rounded bg-danger opacity-75 pb-3 px-3" dir="rtl">
            <div id="loadingText" style="text-align: center; font-size: 1.2rem; margin-bottom: 1rem;" class="text-white">ÿØÿ± ÿ≠ÿßŸÑ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å...</div>
            <div style="width: 300px; background-color: #eee; border-radius: 10px; overflow: hidden;">
                <div id="loader-bar" style="height: 20px; width: 0%; background-color: #4caf50; transition: width 0.5s;"></div>
            </div>
        </div>
    </div>

    <div id="exportPDF"></div>

{% endblock %}

{% block script %}
    <script src="{% static 'js/new/Leaflet.Editable.js' %}"></script>

    <script>
        const setProgress = (percent) => {
            $("#loader-bar").css("width", percent + "%");
        };

        const hideLoader = () => {
            $("#loader-wrapper").fadeOut(500);
        };

        setProgress(0);

        var map = L.map('map').setView([33.8, 54.325], 5);
        var CyclOSM = L.tileLayer('https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png', {
            maxZoom: 20,
        }).addTo(map);
        map.editTools = new L.Editable(map);
        var selectedFeatureName = 'ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÑÿß€åŸá'

        function addAllFeaturesIran() {
            markerGroup.clearLayers();

            const style = {
                color: '#3388ff',
                weight: 1.3,
                opacity: 1,
                fillColor: '#3388ff',
                fillOpacity: 0.1
            };

            allIranGeometry.features.forEach(feature => {
                const layer = L.geoJSON(feature, {style: style}).addTo(map);
                layer.on('click', function () {
                    const jahadFeatures = [];
                    const ostanName = feature.name;
                    allGeometry.features.forEach(f => {
                        const layerOstan = f.properties.ostan;
                        if (ostanName === layerOstan) {
                            jahadFeatures.push(f);
                        }
                    });
                    markerGroup.clearLayers();
                    const geojson = {
                        type: 'FeatureCollection',
                        features: jahadFeatures
                    };
                    L.geoJSON(geojson, {
                        onEachFeature: function (feature, layer) {
                            window.selectedLayer = layer;
                            const center = layer.getBounds().getCenter();
                            const lat = center.lat;
                            const lng = center.lng;
                            const category = feature.properties.tmelk;
                            const icon = icons[category] || icons['default'];
                            const marker = L.marker(center, {icon: icon}).addTo(markerGroup);
                            const name = layer.feature.properties['onvan'];
                            const dbId = layer.feature.properties.dbId;
                            const bounds = layer.getBounds();
                            const area = layer.feature.properties['arse'];
                            const newArea = Number.parseInt(area).toLocaleString('en-US');
                            const imageLink = layer.feature.properties['sardar'].replace('http://localhost:8088',
                                'http://185.213.164.61');
                            layer.on('click', function () {
                                window.selectedLayer = layer;  // ÿß€åŸÜÿ¨ÿß ŸÑÿß€åŸá ÿ±Ÿà ÿ∞ÿÆ€åÿ±Ÿá ŸÖ€å‚Äå⁄©ŸÜ€åŸÖ ÿ®ÿ±ÿß€å ÿßÿ≥ÿ™ŸÅÿßÿØŸá ÿØÿ± ÿ™ÿßÿ®ÿπ enablePolygonEditFromClick

                                const toolContent = `
                        <img src="${imageLink}" class="rounded" alt="ÿ≥ÿ±ÿØÿ±" width="100%" style="max-height: 300px">
                        <div class="tool-container text-right" dir="rtl">
                            <h6>${name}</h6>
                            <div class="tool-list justify-content-around text-center d-flex">
                                <div onclick="openLayerComment(${dbId})"  class="pointerCursor p-1 border border-secondary rounded m-1">
                                    <img src="${downloadSVG}" width="40px" alt="">
                                    <br>
                                    <small>€åÿßÿØÿØÿßÿ¥ÿ™</small>
                                </div>
                                <div class="pointerCursor p-1 border border-secondary rounded m-1" onclick="printLayerDetails(${dbId}, '${lat}', '${lng}')">
                                    <img src="${detailSVG}" width="40px" alt="">
                                    <br>
                                    <small>ÿ¨ÿ≤ÿ¶€åÿßÿ™</small>
                                </div>
                                <div class="pointerCursor p-1 border border-secondary rounded m-1" onclick="openLayerDocuments(${dbId})">
                                    <img src="${documentSVG}" width="40px" alt="">
                                    <br>
                                    <small>ÿßÿ≥ŸÜÿßÿØ</small>
                                </div>
                                <div onclick="enablePolygonEditFromClick()" class="pointerCursor p-1 border border-secondary rounded m-1">
                                    <img src="${editPolygonSVG}" width="40px" alt=""><br>
                                    <small>Ÿà€åÿ±ÿß€åÿ¥</small>
                                </div>
                            </div>
                            <div class="text-center mt-2">
                                <small>ŸÖÿ≥ÿßÿ≠ÿ™: ${newArea} ŸÖÿ™ÿ± ŸÖÿ±ÿ®ÿπ</small>
                            </div>
                        </div>`;

                                const popupLatLng = L.latLng(center.lat + 0.0001, center.lng);
                                L.popup()
                                    .setLatLng(popupLatLng)
                                    .setContent(toolContent)
                                    .openOn(map);
                            });


                            marker.on('click', function () {
                                map.flyToBounds(bounds, {
                                    padding: [200, 200],
                                    duration: 3
                                }).once('zoomend', function () {
                                    const currentZoom = map.getZoom();
                                    if (currentZoom > 15) {
                                        const popupLatLng = L.latLng(center.lat + 0.0001, center.lng);
                                        L.popup()
                                            .setLatLng(popupLatLng)
                                            .setContent(`
                                        <img src="${imageLink}" class="rounded" alt="ÿ≥ÿ±ÿØÿ±" width="100%" style="max-height: 300px">
                                        <div class="tool-container text-right" dir="rtl">
                                            <h6>${name}</h6>
                                            <div class="tool-list justify-content-around text-center d-flex">
                                                <div onclick="openLayerComment(${dbId})" class="pointerCursor p-1 border border-secondary rounded m-1">
                                                    <img src="${downloadSVG}" width="40px" alt="">
                                                    <br>
                                                    <small>€åÿßÿØÿØÿßÿ¥ÿ™</small>
                                                </div>
                                                <div class="pointerCursor p-1 border border-secondary rounded m-1" onclick="printLayerDetails(${dbId}, '${lat}', '${lng}')">
                                                    <img src="${detailSVG}" width="40px" alt="">
                                                    <br>
                                                    <small>ÿ¨ÿ≤ÿ¶€åÿßÿ™</small>
                                                </div>
                                                <div class="pointerCursor p-1 border border-secondary rounded m-1" onclick="openLayerDocuments(${dbId})">
                                                    <img src="${documentSVG}" width="40px" alt="">
                                                    <br>
                                                    <small>ÿßÿ≥ŸÜÿßÿØ</small>
                                                </div>
                                            </div>
                                            <div class="text-center mt-2">
                                                <small>ŸÖÿ≥ÿßÿ≠ÿ™: ${newArea} ŸÖÿ™ÿ± ŸÖÿ±ÿ®ÿπ</small>
                                            </div>
                                        </div>`)
                                            .openOn(map);
                                    }
                                });
                            });
                        }
                    }).addTo(markerGroup);
                });
            });
        }

    </script>
    <script>
        let allGeometry = null;
        let allIranGeometry = null;
        let allBookmarkes = null;
        var loadingText = document.getElementById('loadingText')

        setProgress(10)
        loadingText.innerText = 'ÿ®ÿßÿ±⁄Øÿ≤ÿßÿ±€å Ÿàÿßÿ≠ÿØ Ÿáÿß ...'
        $.getJSON("/api/geodata/", function (geoData) {
            allGeometry = geoData;
            addGroupLayerWithFeatures(allGeometry.features, false, allGeometry.features[0].properties.mainName)
            setProgress(33);

            loadingText.innerText = 'ÿ®ÿßÿ±⁄Øÿ≤ÿßÿ±€å ÿßÿ≥ÿ™ÿßŸÜ Ÿáÿß ...'
            $.getJSON("/api/iran/", function (iranData) {
                allIranGeometry = iranData;
                addAllFeaturesIran();
                setProgress(66);

                setTimeout(hideLoader, 500);

                $.getJSON("/api/bookmarks/", function (bookmarkData) {
                    allBookmarkes = bookmarkData;
                    for (var i = 0; i < allBookmarkes.length; i++) {
                        addGroupLayerWithFeatures(allBookmarkes[i].features, false, allBookmarkes[i].name)
                    }
                });
            });
        });

    </script>

    <script>
        function deleteUpdate(updateId) {
            Swal.fire({
                title: "ÿßÿ≤ ÿ≠ÿ∞ŸÅ ÿß€åŸÜ ÿ™ÿ∫€å€åÿ± ŸÖÿ∑ŸÖÿπŸÜ Ÿáÿ≥ÿ™€åÿØÿü",
                showDenyButton: true,
                showCancelButton: false,
                confirmButtonText: "ÿ≠ÿ∞ŸÅ",
                denyButtonText: `ŸÑÿ∫Ÿà`
            }).then((result) => {
                showLoadingAlert("ÿØÿ±ÿ≠ÿßŸÑ ÿ≠ÿ∞ŸÅ ÿ™ÿ∫€å€åÿ±")
                setTimeout(function () {
                    const formData = new FormData();
                    formData.append('updateId', updateId)
                    $.ajax({
                        type: "post",
                        headers: {
                            'X-CSRFToken': csrftoken,
                        },
                        url: "/delete-change",
                        data: formData,
                        contentType: false,
                        processData: false,
                        success: function (data) {
                            Swal.close()
                            if (data.check) {
                                var tbody = document.getElementById('changeTableBody');
                                var tr = document.getElementById('changeTr' + updateId);
                                tbody.removeChild(tr)
                                showTimerGreenAlert("ÿ™ÿ∫€å€åÿ± ÿßŸÜÿ™ÿÆÿßÿ® ÿ¥ÿØŸá ÿ≠ÿ∞ŸÅ ÿ¥ÿØ", 2000)
                            } else {
                                showTimerRedAlert('ÿ´ÿ®ÿ™ ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ®ÿß ÿÆÿ∑ÿß ŸáŸÖÿ±ÿßŸá ÿ®ŸàÿØ', 2000);
                            }
                        },
                        error: function () {
                            showTimerRedAlert("ÿ≠ÿ∞ŸÅ ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ®ÿß ÿÆÿ∑ÿß ŸáŸÖÿ±ÿßŸá ÿ®ŸàÿØ", 2000);
                        }
                    });
                }, 500);
            });
        }

        function approveUpdate(updateId) {
            Swal.fire({
                title: "ÿ®ÿß ÿ™ÿß€å€åÿØ ÿß€åŸÜ ⁄Øÿ≤€åŸÜŸá ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ¨ÿØ€åÿØ ÿ¨ÿß€å⁄Øÿ≤€åŸÜ ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÇÿ®ŸÑ€å ÿÆŸàÿßŸáÿØ ÿ¥ÿØ",
                showDenyButton: true,
                showCancelButton: false,
                confirmButtonText: "Ÿà€åÿ±ÿß€åÿ¥ ÿßÿ∑ŸÑÿßÿπÿßÿ™",
                denyButtonText: `ŸÑÿ∫Ÿà`
            }).then((result) => {
                showLoadingAlert("ÿØÿ±ÿ≠ÿßŸÑ Ÿà€åÿ±ÿß€åÿ¥ ÿßÿ∑ŸÑÿßÿπÿßÿ™")
                setTimeout(function () {
                    const formData = new FormData();
                    formData.append('updateId', updateId)
                    $.ajax({
                        type: "post",
                        headers: {
                            'X-CSRFToken': csrftoken,
                        },
                        url: "/approve-change",
                        data: formData,
                        contentType: false,
                        processData: false,
                        success: function (data) {
                            Swal.close()
                            if (data.check) {
                                var tbody = document.getElementById('changeTableBody');
                                var tr = document.getElementById('changeTr' + updateId);
                                tbody.removeChild(tr)
                                showTimerGreenAlert("ÿ™ÿ∫€å€åÿ± ÿßŸÜÿ™ÿÆÿßÿ® ÿ¥ÿØŸá ÿßÿπŸÖÿßŸÑ ÿ¥ÿØ", 2000)
                            } else {
                                showTimerRedAlert('ÿ´ÿ®ÿ™ ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ®ÿß ÿÆÿ∑ÿß ŸáŸÖÿ±ÿßŸá ÿ®ŸàÿØ', 2000);
                            }
                        },
                        error: function () {
                            showTimerRedAlert("ÿ≠ÿ∞ŸÅ ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ®ÿß ÿÆÿ∑ÿß ŸáŸÖÿ±ÿßŸá ÿ®ŸàÿØ", 2000);
                        }
                    });
                }, 500);
            });
        }

        document.getElementById('searchInput').addEventListener('keyup', function () {
            let searchValue = this.value.toLowerCase();
            let rows = document.querySelectorAll('#unitTable tbody tr');
            rows.forEach(row => {
                let text = row.innerText.toLowerCase();
                row.style.display = text.includes(searchValue) ? '' : 'none';
            });
        });

        function searchDocuments(name, ostan) {
            showLoadingAlert("ÿØÿ±ÿ≠ÿßŸÑ ÿ¨ÿ≥ÿ™ÿ¨Ÿà ÿßÿ≥ŸÜÿßÿØ")
            setTimeout(function () {
                const formData = new FormData();
                formData.append('name', name)
                formData.append('ostan', ostan)
                $.ajax({
                    type: "post",
                    headers: {
                        'X-CSRFToken': csrftoken,
                    },
                    url: "/find-document",
                    data: formData,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        Swal.close()
                        if (data.check) {
                            var tbody = document.querySelector('#docTable tbody');
                            tbody.innerHTML = '';
                            var docData = data.data;
                            var mergedDocs = [];
                            for (var i = 0; i < docData.length; i++) {
                                if (Array.isArray(docData[i])) {
                                    for (var j = 0; j < docData[i].length; j++) {
                                        mergedDocs.push(docData[i][j]);
                                    }
                                }
                            }

                            function renderTable(docs) {
                                var tbody = document.querySelector('#docTable tbody');
                                tbody.innerHTML = '';
                                for (var i = 0; i < docs.length; i++) {
                                    var doc = docs[i];
                                    var row = '<tr>' +
                                        '<td>' + (i + 1) + '</td>' +
                                        '<td>' + doc.docName + '</td>' +
                                        '<td>' + doc.onvanName + '</td>' +
                                        '<td>' + doc.vahedName + '</td>' +
                                        '<td>' + doc.uploadedDate + '</td>' +
                                        '<td>' + doc.uploadedBy + '</td>' +
                                        '<td><a href="' + doc.downloadUrl + '" target="_blank" class="btn btn-sm btn-primary">ÿØÿßŸÜŸÑŸàÿØ</a></td>' +
                                        '</tr>';
                                    tbody.innerHTML += row;
                                }
                            }

                            renderTable(mergedDocs);
                            document.getElementById('docSearch').addEventListener('input', function () {
                                var value = this.value.trim().toLowerCase();
                                var filtered = mergedDocs.filter(function (doc) {
                                    return Object.values(doc).some(function (val) {
                                        return val && val.toString().toLowerCase().includes(value);
                                    });
                                });
                                renderTable(filtered);
                            });
                            var myModal = new bootstrap.Modal(document.getElementById('documentsModal'));
                            myModal.show();
                            document.getElementById('closeMainDocumentModal').click()
                        } else {
                            showTimerRedAlert('ÿ´ÿ®ÿ™ ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ®ÿß ÿÆÿ∑ÿß ŸáŸÖÿ±ÿßŸá ÿ®ŸàÿØ', 2000);
                        }
                    },
                    error: function () {
                        showTimerRedAlert("ÿ´ÿ®ÿ™ ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ®ÿß ÿÆÿ∑ÿß ŸáŸÖÿ±ÿßŸá ÿ®ŸàÿØ", 2000);
                    }
                });
            }, 500);
        }
    </script>
    <script src="{% static 'js/new/leaflet-image.js' %}"></script>
    <script src="{% static 'js/new/chart.js' %}"></script>
    <script src="{% static 'js/new/proj4.js' %}"></script>
    <script src="{% static 'js/new/jspdf.es.min.js' %}"></script>
    <script src="{% static 'js/new/leaflet.draw.js' %}"></script>
    <script src="{% static 'js/new/turf.min.js' %}"></script>
    <script>
        var drawnItems = new L.FeatureGroup();
        map.addLayer(drawnItems);
        var drawControl = new L.Control.Draw({
            edit: {
                featureGroup: drawnItems
            },
            draw: {
                polygon: true,
                polyline: false,
                rectangle: true,
                circle: false,
                circlemarker: false,
                marker: false
            }
        });
        map.addControl(drawControl);
        map.on('draw:created', function (event) {
            var layer = event.layer;
            drawnItems.addLayer(layer);
            var geojsonData = layer.toGeoJSON();
            checkFeaturesInsidePolygon(geojsonData, allGeometry)
        });

        function checkFeaturesInsidePolygon(lastDrawnPolygon, geojsonData) {
            var insidePolygons = geojsonData.features.filter(function (feature) {
                if (feature.geometry.type === "MultiPolygon") {
                    return feature.geometry.coordinates.some(polygonCoords => {
                        var polygonFeature = turf.polygon(polygonCoords);
                        return turf.booleanContains(lastDrawnPolygon.geometry, polygonFeature.geometry);
                    });
                } else {
                    return turf.booleanContains(lastDrawnPolygon.geometry, feature.geometry);
                }
            });
            var count = insidePolygons.length;

            var geojsonOutput = {
                "type": "FeatureCollection",
                "features": insidePolygons
            };

            const swalWithBootstrapButtons = Swal.mixin({
                customClass: {
                    confirmButton: "btn btn-success",
                    cancelButton: "btn btn-danger"
                },
                buttonsStyling: false
            });
            swalWithBootstrapButtons.fire({
                title: "ŸÜÿ™€åÿ¨Ÿá ÿ¨ÿ≥ÿ™ÿ¨Ÿà",
                text: `ÿ™ÿπÿØÿßÿØ ${count} ŸÖŸÑ⁄© ÿØÿ± ŸÖÿ≠ÿØŸàÿØŸá Ÿàÿßÿ±ÿØ ÿ¥ÿØŸá €åÿßŸÅÿ™ ÿ¥ÿØ`,
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "ÿßŸÅÿ≤ŸàÿØŸÜ ÿ®Ÿá ŸÜŸÇÿ¥Ÿá",
                cancelButtonText: "ŸÑÿ∫ÿ±",
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    addGroupLayerWithFeatures(geojsonOutput.features, true, 'ŸÖÿ≠ÿØŸàÿØŸá ÿ±ÿ≥ŸÖ ÿ¥ÿØŸá',)
                } else {
                    drawnItems.clear()
                }
            });
        }
    </script>
    <script>
        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;

        function addNewFeature() {
            showLoadingAlert('ÿØÿ± ÿ≠ÿßŸÑ ÿ®ÿßÿ±⁄Øÿ≤ÿßÿ±€å ÿßÿ∑ŸÑÿßÿπÿßÿ™')
            const polygonPointsInput = document.getElementById('polygonPointsInput');
            const pointRows = polygonPointsInput.querySelectorAll('.point-row');
            if (pointRows.length < 3) {
                showTimerRedAlert('ÿ®ÿ±ÿß€å ÿß€åÿ¨ÿßÿØ €å⁄© ⁄ÜŸÜÿØ ÿ∂ŸÑÿπ€åÿå ÿ≠ÿØÿßŸÇŸÑ ÿ®Ÿá ÿ≥Ÿá ŸÜŸÇÿ∑Ÿá ŸÜ€åÿßÿ≤ ÿßÿ≥ÿ™.', 2000);
            } else {
                const coordinates = [];
                pointRows.forEach(row => {
                    const longitudeInput = row.querySelector('.longitude-input');
                    const latitudeInput = row.querySelector('.latitude-input');
                    if (longitudeInput && latitudeInput) {
                        const longitude = parseFloat(longitudeInput.value);
                        const latitude = parseFloat(latitudeInput.value);
                        if (!isNaN(longitude) && !isNaN(latitude)) {
                            coordinates.push([longitude, latitude]);
                        } else {
                            showTimerRedAlert('ŸÑÿ∑ŸÅÿßŸã ŸÖŸÇÿßÿØ€åÿ± ÿ∑ŸàŸÑ Ÿà ÿπÿ±ÿ∂ ÿ¨ÿ∫ÿ±ÿßŸÅ€åÿß€å€å ŸÖÿπÿ™ÿ®ÿ± Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ.', 2000);
                        }
                    }
                });

                if (coordinates.length < 3) {
                    showTimerRedAlert('ÿ®ÿ±ÿß€å ÿß€åÿ¨ÿßÿØ €å⁄© ⁄ÜŸÜÿØ ÿ∂ŸÑÿπ€åÿå ÿ≠ÿØÿßŸÇŸÑ ÿ®Ÿá ÿ≥Ÿá ŸÜŸÇÿ∑Ÿá ŸÖÿπÿ™ÿ®ÿ± ŸÜ€åÿßÿ≤ ÿßÿ≥ÿ™.', 2000);
                    return;
                }
                coordinates.push(coordinates[0]);
                const geojsonFeature = {
                    type: 'Feature',
                    geometry: {
                        type: 'Polygon',
                        coordinates: [coordinates]
                    },
                };
                const geojsonObject = {
                    type: 'FeatureCollection',
                    features: [geojsonFeature]
                };
                const geojsonString = JSON.stringify(geojsonObject);
                const geojsonBlob = new Blob([geojsonString], {type: 'application/json'});
                const formData = new FormData();

                formData.append('geojson_file', geojsonBlob, 'polygon.geojson');
                const form = document.getElementById('allNewFileForm');
                const formElements = form.querySelectorAll('input, textarea, select');
                formElements.forEach(element => {
                    if (element.id) {
                        formData.append(element.id, element.value);
                    }
                });

                setTimeout(function () {
                    $.ajax({
                        type: "post",
                        headers: {
                            'X-CSRFToken': csrftoken,
                        },
                        url: "/add-new-file",
                        data: formData,
                        contentType: false,
                        processData: false,
                        success: function (data) {
                            if (data.status === 201) {
                            } else {
                                showTimerRedAlert('ÿ´ÿ®ÿ™ ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ®ÿß ÿÆÿ∑ÿß ŸáŸÖÿ±ÿßŸá ÿ®ŸàÿØ', 2000);
                            }
                        },
                        error: function () {
                            showTimerRedAlert("ÿ´ÿ®ÿ™ ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ®ÿß ÿÆÿ∑ÿß ŸáŸÖÿ±ÿßŸá ÿ®ŸàÿØ", 2000);
                        }
                    });
                }, 500);
            }
        }

        const offCanvas1 = document.getElementById("attributeTableOffCanvas");
        const resizeDiv = document.querySelector(".resize-div");
        let isResizing = false;
        let startY;
        resizeDiv.addEventListener("mousedown", (event) => {
            isResizing = true;
            startY = event.clientY;
            document.body.style.cursor = "ns-resize";
        });
        document.addEventListener("mousemove", (event) => {
            if (isResizing) {
                const heightChange = startY - event.clientY;
                const newHeight = Math.max(offCanvas1.offsetHeight + heightChange, 100); // ÿ≠ÿØÿßŸÇŸÑ ÿßÿ±ÿ™ŸÅÿßÿπ 100px
                offCanvas1.style.height = `${newHeight}px`;
                startY = event.clientY;
            }
        });
        document.addEventListener("mouseup", () => {
            isResizing = false;
            document.body.style.cursor = "default";
        });

        async function urlToBase64(url) {
            const response = await fetch(url);
            const blob = await response.blob();
            const reader = new FileReader();
            return new Promise((resolve, reject) => {
                reader.onloadend = () => resolve(reader.result.split(',')[1]);
                reader.onerror = reject;
                reader.readAsDataURL(blob);
            });
        }
    </script>
    <script>
        jalaliDatepicker.startWatch({
            zIndex: 10000
        });
        var addDviId = 1;
        var reportIndex = 0;

        function filterReportDate(dbId) {
            var firstDate = document.getElementById('firstDate').value;
            var endDate = document.getElementById('endDate').value;
            Swal.fire({
                title: "ÿØÿ± ÿ≠ÿßŸÑ Ÿæÿ±ÿØÿßÿ≤ÿ¥ ÿßÿ∑ŸÑÿßÿπÿßÿ™",
                didOpen: () => {
                    Swal.showLoading();
                },
            })

            setTimeout(function () {
                $.ajax({
                    url: '/filter-report',
                    type: 'post',
                    data: {
                        'firstDate': firstDate,
                        'endDate': endDate,
                        'dbId': reportIndex
                    },
                    success: function (data) {
                        Swal.close()
                        if (data.check) {
                            const tableBody = document.getElementById('tableBody');
                            tableBody.innerHTML = '';
                            index = 0;
                            data.changes.forEach(item => {
                                index++;
                                const row = document.createElement('tr');
                                const rowNumber = document.createElement('td');
                                const cellUsername = document.createElement('td');
                                const cellKey = document.createElement('td');
                                const cellOldValue = document.createElement('td');
                                const cellNewValue = document.createElement('td');
                                const cellDate = document.createElement('td');

                                cellUsername.textContent = item.username;
                                rowNumber.textContent = index;
                                cellKey.textContent = persianName[item.key];
                                cellOldValue.textContent = item.old_value;
                                cellNewValue.textContent = item.new_value;
                                cellDate.textContent = item.date;

                                row.appendChild(rowNumber);
                                row.appendChild(cellUsername);
                                row.appendChild(cellKey);
                                row.appendChild(cellOldValue);
                                row.appendChild(cellNewValue);
                                row.appendChild(cellDate);
                                tableBody.appendChild(row);
                            });
                        } else {
                            Swal.fire({
                                position: "top-end",
                                icon: "warning",
                                title: "ÿÆÿ∑ÿß€å ÿ≥ÿ±Ÿàÿ± ÿ±ÿÆ ÿØÿßÿØ",
                                showConfirmButton: false,
                                timer: 3000
                            });
                        }
                    },
                    error: function (e) {
                        Swal.close()
                        Swal.fire({
                            position: "top-end",
                            icon: "warning",
                            title: "ÿÆÿ∑ÿß€å ÿ≥ÿ±Ÿàÿ± ÿ±ÿÆ ÿØÿßÿØ",
                            showConfirmButton: false,
                            timer: 1500
                        });
                    },
                    failure: function (data) {
                        Swal.close()
                        Swal.fire({
                            position: "top-end",
                            icon: "warning",
                            title: "ÿÆÿ∑ÿß€å ÿ≥ÿ±Ÿàÿ± ÿ±ÿÆ ÿØÿßÿØ",
                            showConfirmButton: false,
                            timer: 1500
                        });
                    }
                });
            }, 100)
        }
    </script>
    <script>
        let selectedGeometryForClassify;
        const viewSVG = '{% static "images/svg/view.svg" %}'
        const findMap = '{% static "images/svg/findMap.svg" %}'
        const downloadSVG = '{% static "images/svg/download.svg" %}'
        const zoomSVG = '{% static "images/svg/zoom.svg" %}'
        const logSVG = '{% static "images/svg/logs.svg" %}'
        const documentSVG = '{% static "images/svg/documents.svg" %}'
        const editPolygonSVG = '{% static "images/svg/edit_polygon.svg" %}'
        const editSVG = '{% static "images/svg/edit.svg" %}'
        const editSVGRed = '{% static "images/svg/edit_red.svg" %}'
        const printerSVG = '{% static "images/svg/printer.svg" %}'
        const detailSVG = '{% static "images/svg/detail.svg" %}'
        const buildingSVG = '{% static "images/svg/building.svg" %}'
        const greenhouseSVG = '{% static "images/svg/greenhouse.svg" %}'
        const landSVG = '{% static "images/svg/land.svg" %}'
        const apartmentSVG = '{% static "images/svg/apartment.svg" %}'
        const defaultSVG = '{% static "images/svg/location.svg" %}'
        const chatBotSVG = '{% static "images/svg/chatBot.svg" %}'
        const closeSVG = '{% static "images/svg/close.svg" %}'
        const approveSVG = '{% static "images/new/190411.png" %}'
        const deleteSVG = '{% static "images/new/1345874.png" %}'
        const provinceList = {{ provinceList | safe }};
    </script>
    <script src="{% static 'js/new/html2pdf.bundle.min.js' %}"></script>
    <script src="{% static 'js/new/exceljs.min.js' %}"></script>
    <script src="{% static 'js/new/FileSaver.min.js' %}"></script>
    <script src="{% static 'js/basic.js' %}"></script>
    <script src="{% static 'js/new/pdf.min.js' %}"></script>
    <script src="{% static 'js/new/xlsx.full.min.js' %}"></script>
    <script src="{% static 'js/openData.js' %}"></script>
    <script src="{% static 'js/layers.js' %}"></script>
    <script>
        function setActiveStep(index) {
            var steps = document.getElementsByClassName('step');
            for (var i = 0; i < steps.length; i++) {
                steps[i].classList.remove('active-step');
            }
            steps[index].classList.add('active-step');

            var contents = document.getElementsByClassName('content');
            for (var i = 0; i < contents.length; i++) {
                contents[i].classList.remove('active-content');
            }
            document.getElementById('content-' + index).classList.add('active-content');
        }
    </script>
    <script src="{% static 'js/reports.js' %}"></script>
    <script>
        const offcanvas = document.getElementById("rightOffCanvas");
        const resizer = offcanvas.querySelector(".resizer");
        resizer.addEventListener("mousedown", (e) => {
            document.body.style.userSelect = "none";
            document.addEventListener("mousemove", resize);
            document.addEventListener("mouseup", stopResize);
        });

        function resize(e) {
            const newWidth = e.clientX - offcanvas.getBoundingClientRect().left;
            if (newWidth >= 150 && newWidth <= 600) {
                offcanvas.style.width = `${newWidth}px`;
            }
        }

        function stopResize() {
            document.body.style.userSelect = "";
            document.removeEventListener("mousemove", resize);
            document.removeEventListener("mouseup", stopResize);
        }
    </script>
    <script>
        var selectedFeatures = [];
        var filterConditionCounter = 1;
        var allFeatures = allGeometry?.features || [];
        var selectedFields = {};

        function normalizeString(str) {
            return String(str || "").toLowerCase().trim();
        }

        function populateAttributeFields(data) {
            const attributeFieldDropdowns = document.querySelectorAll('.attributeField');
            if (data && data.length > 0) {
                const firstFeature = data[0];
                const fields = Object.keys(firstFeature.properties);
                attributeFieldDropdowns.forEach(dropdown => {
                    dropdown.innerHTML = '<option value="">ÿßŸÜÿ™ÿÆÿßÿ® ŸÅ€åŸÑÿØ</option>';
                    fields.forEach(field => {
                        if (persianName[field] !== undefined) {
                            const option = document.createElement('option');
                            option.value = field;
                            option.textContent = persianName[field];
                            dropdown.appendChild(option);
                        }
                    });

                    const fieldId = dropdown.id.split('_')[1];
                    if (selectedFields[fieldId]) {
                        dropdown.value = selectedFields[fieldId];
                    }

                    dropdown.addEventListener('change', function () {
                        const fieldId = this.id.split('_')[1];
                        selectedFields[fieldId] = this.value;
                        if (this.value) {
                            const newDropDown = document.getElementById('allNewValueToSelect_' + (this.id.split('_')[1]));
                            const input = document.getElementById('attributeValue_' + (this.id.split('_')[1]));
                            if (newDropDown) newDropDown.innerHTML = '';
                            const allOptions = new Set();
                            for (const feature of allFeatures) {
                                const propValue = feature.properties[this.value];
                                if (propValue !== undefined && !allOptions.has(propValue)) {
                                    allOptions.add(propValue);
                                    const newOption = document.createElement('li');
                                    newOption.className = 'dropdown-item';
                                    newOption.style.color = 'black'
                                    newOption.textContent = propValue;
                                    newDropDown.appendChild(newOption);
                                    newOption.addEventListener('click', function () {
                                        input.value = this.textContent;
                                    });
                                }
                            }
                        }
                    });
                });
            }
        }

        document.getElementById('addFilterCondition').addEventListener('click', function () {
            const filterConditionsDiv = document.getElementById('filterConditions');
            const newConditionDiv = document.createElement('div');
            newConditionDiv.className = 'filter-condition';
            newConditionDiv.innerHTML = `
                        <div class="row g-2 align-items-center mb-2">
                            <div class="col-md-1 text-center">
                                <select class="form-select form-select-sm conditionConnector" id="conditionConnector_${filterConditionCounter}">
                                    <option value="AND">Ÿà</option>
                                    <option value="OR">€åÿß</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <select class="form-select form-select-sm attributeField" id="attributeField_${filterConditionCounter}">
                                    <option value="">ÿßŸÜÿ™ÿÆÿßÿ® ŸÅ€åŸÑÿØ</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select form-select-sm comparisonOperator" id="comparisonOperator_${filterConditionCounter}">
                                    <option value="equals">ÿ®ÿ±ÿßÿ®ÿ± ÿßÿ≥ÿ™ ÿ®ÿß</option>
                                    <option value="notEquals">ŸÜÿßÿ®ÿ±ÿßÿ®ÿ± ÿßÿ≥ÿ™ ÿ®ÿß</option>
                                    <option value="greaterThan">ÿ®ÿ≤ÿ±⁄Øÿ™ÿ± ÿßÿ≤</option>
                                    <option value="lessThan">⁄©Ÿà⁄Ü⁄©ÿ™ÿ± ÿßÿ≤</option>
                                    <option value="contains">ÿ¥ÿßŸÖŸÑ ŸÖ€å‚Äåÿ¥ŸàÿØ</option>
                                    <option value="startsWith">ÿ¥ÿ±Ÿàÿπ ŸÖ€å‚Äåÿ¥ŸàÿØ ÿ®ÿß</option>
                                    <option value="endsWith">ÿ™ŸÖÿßŸÖ ŸÖ€å‚Äåÿ¥ŸàÿØ ÿ®ÿß</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <div class="input-group" dir="ltr">
                                    <button class="btn btn-sm btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">ÿßŸÜÿ™ÿÆÿßÿ®</button>
                                    <ul class="dropdown-menu dropdown-menu-end text-end" id="allNewValueToSelect_${filterConditionCounter}" style="max-height: 300px; overflow-y: auto;"></ul>
                                    <input type="text" class="form-control form-select-sm attributeValue" id="attributeValue_${filterConditionCounter}" placeholder="ŸÖÿ™ŸÜ ÿ¨ÿ≥ÿ™ÿ¨Ÿà...">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <button type="button" class="btn btn-sm btn-danger remove-condition">ÿ≠ÿ∞ŸÅ</button>
                            </div>
                        </div>
                    `;
            filterConditionsDiv.appendChild(newConditionDiv);

            populateAttributeFields(allFeatures);
            filterConditionCounter++;

            newConditionDiv.querySelector('.remove-condition').addEventListener('click', function () {
                newConditionDiv.remove();
            });
        });

        function applyAttributeFilter() {
            const conditions = document.querySelectorAll('.filter-condition');
            const layerName = document.getElementById('newLayerName').value.trim();
            if (layerName === '') {
                showTimerRedAlert('ŸÑÿ∑ŸÅÿß €å⁄© ŸÜÿßŸÖ ÿ±ÿß ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ', 2000);
                return;
            }

            selectedFeatures = [];

            const groupedConditions = {};
            conditions.forEach(condition => {
                const attributeField = condition.querySelector('.attributeField').value;
                const comparisonOperator = condition.querySelector('.comparisonOperator').value;
                const attributeValue = condition.querySelector('.attributeValue').value;
                const conditionConnectorElement = condition.querySelector('.conditionConnector');
                const conditionConnector = conditionConnectorElement ? conditionConnectorElement.value : 'AND'; // Ÿæ€åÿ¥ ŸÅÿ±ÿ∂ ÿ®ÿ±ÿß€å ÿßŸàŸÑ€åŸÜ ÿ¥ÿ±ÿ∑

                if (!attributeField || !comparisonOperator) return;

                const conditionObj = {
                    comparisonOperator,
                    attributeValue,
                    connector: conditionConnector
                };

                if (!groupedConditions[attributeField]) {
                    groupedConditions[attributeField] = [];
                }
                groupedConditions[attributeField].push(conditionObj);
            });

            for (const feature of allFeatures) {
                let allFieldsMatched = true;

                for (const field in groupedConditions) {
                    const fieldConditions = groupedConditions[field];
                    let fieldMatch = false;

                    for (let i = 0; i < fieldConditions.length; i++) {
                        const condition = fieldConditions[i];
                        const featureValueRaw = feature.properties[field];
                        const featureValue = normalizeString(featureValueRaw);
                        const inputValue = normalizeString(condition.attributeValue);
                        let match = false;

                        switch (condition.comparisonOperator) {
                            case 'equals':
                                match = featureValue === inputValue;
                                break;
                            case 'notEquals':
                                match = featureValue !== inputValue;
                                break;
                            case 'greaterThan':
                                match = Number(featureValueRaw) > Number(condition.attributeValue);
                                break;
                            case 'lessThan':
                                match = Number(featureValueRaw) < Number(condition.attributeValue);
                                break;
                            case 'contains':
                                match = featureValue.includes(inputValue);
                                break;
                            case 'startsWith':
                                match = featureValue.startsWith(inputValue);
                                break;
                            case 'endsWith':
                                match = featureValue.endsWith(inputValue);
                                break;
                        }

                        if (i === 0) {
                            fieldMatch = match;
                        } else {
                            if (condition.connector === 'AND') {
                                fieldMatch = fieldMatch && match;
                            } else if (condition.connector === 'OR') {
                                fieldMatch = fieldMatch || match;
                            }
                        }
                    }

                    if (!fieldMatch) {
                        allFieldsMatched = false;
                        break;
                    }
                }
                if (allFieldsMatched) {
                    selectedFeatures.push(feature);
                }
            }
            addGroupLayerWithFeatures(selectedFeatures, true, layerName);
            const selectByAttributeModal = bootstrap.Modal.getInstance(document.getElementById('selectByAttributeModal'));
            selectByAttributeModal.hide();
        }

        document.getElementById('applySelection').addEventListener('click', applyAttributeFilter);

    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const addPointButton = document.getElementById('addPoint');
            const polygonPointsInput = document.getElementById('polygonPointsInput');

            function createPointRow() {
                const pointRow = document.createElement('div');
                pointRow.classList.add('row', 'g-2', 'align-items-center', 'mb-3', 'point-row');
                pointRow.innerHTML = `
                    <div class="col">
                        <input type="number" class="form-control form-control-sm longitude-input"
                               placeholder="X (ÿ∑ŸàŸÑ)" name="x[]">
                    </div>
                    <div class="col">
                        <input type="number" class="form-control form-control-sm latitude-input"
                               placeholder="Y (ÿπÿ±ÿ∂)" name="y[]">
                    </div>
                    <div class="col-auto">
                        <button type="button" class="btn btn-danger btn-sm remove-point">ÿ≠ÿ∞ŸÅ</button>
                    </div>
                `;
                return pointRow;
            }

            addPointButton.addEventListener('click', function () {
                const pointRows = polygonPointsInput.querySelectorAll('.point-row');
                if (pointRows.length < 10) {
                    const newPointRow = createPointRow();
                    polygonPointsInput.appendChild(newPointRow);
                    attachRemovePointListener(newPointRow.querySelector('.remove-point'));
                    updateRemoveButtonVisibility();
                } else {
                    alert('ÿ≠ÿØÿß⁄©ÿ´ÿ± ÿ™ÿπÿØÿßÿØ ŸÜŸÇÿßÿ∑ ŸÖÿ¨ÿßÿ≤ ÿßÿ≥ÿ™.');
                }
            });

            function attachRemovePointListener(removeButton) {
                removeButton.addEventListener('click', function () {
                    const pointRow = this.closest('.point-row');
                    pointRow.remove();
                    updateRemoveButtonVisibility();
                });
            }

            function updateRemoveButtonVisibility() {
                const pointRows = polygonPointsInput.querySelectorAll('.point-row');
                const removeButtons = polygonPointsInput.querySelectorAll('.remove-point');

                removeButtons.forEach(button => {
                    button.disabled = pointRows.length <= 3;
                });
            }

            const initialRemoveButtons = polygonPointsInput.querySelectorAll('.remove-point');
            initialRemoveButtons.forEach(attachRemovePointListener);

            updateRemoveButtonVisibility();

        });
        const detailDiv = document.getElementById("newMapDetail");

        function checkAndToggleBorder() {
            if (detailDiv.innerHTML.trim() !== "") {
                detailDiv.classList.add("with-border");
            } else {
                detailDiv.classList.remove("with-border");
            }
        }

        checkAndToggleBorder();
    </script>
{% endblock %}
